(function(){"use strict";const t={totalAdSpend:document.getElementById("totalAdSpend"),totalAdRevenue_fromAds:document.getElementById("totalAdRevenue_fromAds"),averageProductProfitMargin_percent:document.getElementById("averageProductProfitMargin_percent"),adv_averageProductProfitMargin_percent:document.getElementById("adv_averageProductProfitMargin_percent"),adv_totalAdRevenue_fromAds:document.getElementById("adv_totalAdRevenue_fromAds"),adv_totalAdSpend:document.getElementById("adv_totalAdSpend"),adImpressions:document.getElementById("adImpressions"),adClicks:document.getElementById("adClicks"),adOrders:document.getElementById("adOrders"),dailyAdBudget:document.getElementById("dailyAdBudget"),performancePeriodDropdown:document.getElementById("performancePeriodDropdown"),currencySymbol:document.getElementById("currencySymbol"),totalOverallShopRevenue:document.getElementById("totalOverallShopRevenue"),totalOverallShopOrders:document.getElementById("totalOverallShopOrders"),totalShopVisits:document.getElementById("totalShopVisits"),roasStatValue:document.getElementById("roasStatValue"),breakevenRoasStatValue:document.getElementById("breakevenRoasStatValue"),netAdProfitStatValue:document.getElementById("netAdProfitStatValue"),profitabilityStatusBadge:document.getElementById("profitabilityStatusBadge"),profitabilityMessageCard:document.getElementById("profitabilityMessageCard"),profitabilityMessageTitle:document.getElementById("profitabilityMessageTitle"),profitabilityMessageText:document.getElementById("profitabilityMessageText"),toggleNormalViewButton:document.getElementById("toggleNormalViewButton"),toggleAdvancedViewButton:document.getElementById("toggleAdvancedViewButton"),normalInputsContainer:document.getElementById("normalInputsContainer"),advancedInputsContainer:document.getElementById("advancedInputsContainer"),advertisingAnalysisSectionWrapper:document.getElementById("advertisingAnalysisSectionWrapper"),organicVsAdComparisonSectionWrapper:document.getElementById("organicVsAdComparisonSectionWrapper"),budgetUtilizationSectionWrapper:document.getElementById("budgetUtilizationSectionWrapper"),budgetUtilizationText:document.getElementById("budgetUtilizationText"),budgetUtilizationProgressBarFill:document.getElementById("budgetUtilizationProgressFill"),budgetUtilizationPercentageOnBar:document.getElementById("budgetUtilizationPercentageOnBar"),recommendationsSection:document.getElementById("recommendationsSection"),recommendationsEmptyState:document.getElementById("recommendationsEmptyState"),recommendationOutputArea:document.getElementById("recommendationOutputArea"),categoryFilters:document.getElementById("categoryFilters"),recommendationsListContainer:document.getElementById("recommendationsListContainer"),adAnalysisTabButtons:document.querySelectorAll(".a--ad-analysis-tab-button"),adAnalysisTabContents:document.querySelectorAll(".a--ad-analysis-tab-content"),comparisonMetricsTabButtons:document.querySelectorAll(".a--comparison-tab-button"),comparisonMetricsTabContents:document.querySelectorAll(".a--comparison-tab-content"),exportCsvButton:document.getElementById("exportCsvButton"),aa_performancePeriod:document.getElementById("aa_performancePeriod"),aa_totalAdSpend_sum:document.getElementById("aa_totalAdSpend_sum"),aa_totalAdRevenue_sum:document.getElementById("aa_totalAdRevenue_sum"),aa_adOrders_sum:document.getElementById("aa_adOrders_sum"),aa_netAdProfit_sum:document.getElementById("aa_netAdProfit_sum"),aa_ROAS_kpr:document.getElementById("aa_ROAS_kpr"),aa_ACOS_kpr:document.getElementById("aa_ACOS_kpr"),aa_CVR_kpr:document.getElementById("aa_CVR_kpr"),aa_CPA_kpr:document.getElementById("aa_CPA_kpr"),aa_totalAdRevenue_prof:document.getElementById("aa_totalAdRevenue_prof"),aa_totalAdSpend_prof:document.getElementById("aa_totalAdSpend_prof"),aa_COGS_prof:document.getElementById("aa_COGS_prof"),aa_totalCosts_prof:document.getElementById("aa_totalCosts_prof"),aa_netProfit_prof:document.getElementById("aa_netProfit_prof"),aa_netProfitMargin_prof:document.getElementById("aa_netProfitMargin_prof"),aa_profitStatus_prof:document.getElementById("aa_profitStatus_prof"),aa_ROAS_prof:document.getElementById("aa_ROAS_prof"),aa_breakevenROAS_prof:document.getElementById("aa_breakevenROAS_prof"),aa_ACOS_prof:document.getElementById("aa_ACOS_prof"),aa_breakevenACOS_prof:document.getElementById("aa_breakevenACOS_prof"),aa_adImpressions_eng:document.getElementById("aa_adImpressions_eng"),aa_adClicks_eng:document.getElementById("aa_adClicks_eng"),aa_CTR_eng:document.getElementById("aa_CTR_eng"),aa_totalAdSpend_eng:document.getElementById("aa_totalAdSpend_eng"),aa_CPC_eng:document.getElementById("aa_CPC_eng"),aa_CPM_eng:document.getElementById("aa_CPM_eng"),aa_RPC_eng:document.getElementById("aa_RPC_eng"),aa_PPC_eng:document.getElementById("aa_PPC_eng"),aa_adOrders_eng:document.getElementById("aa_adOrders_eng"),aa_CVR_eng:document.getElementById("aa_CVR_eng"),aa_AOV_eng:document.getElementById("aa_AOV_eng"),aa_CPA_eng:document.getElementById("aa_CPA_eng"),aa_profitPerSale_eng:document.getElementById("aa_profitPerSale_eng"),co_blendedROAS:document.getElementById("co_blendedROAS"),co_overallShopNetProfitLoss:document.getElementById("co_overallShopNetProfitLoss"),co_TACoS_percent:document.getElementById("co_TACoS_percent"),co_percentRevenueFromAds:document.getElementById("co_percentRevenueFromAds"),co_percentOrdersFromAds:document.getElementById("co_percentOrdersFromAds"),co_combinedConversionRate:document.getElementById("co_combinedConversionRate"),co_combinedAOV:document.getElementById("co_combinedAOV"),co_adSpendToOverallGrossProfitRatio_percent:document.getElementById("co_adSpendToOverallGrossProfitRatio_percent"),cdt_ad_visits:document.getElementById("cdt_ad_visits"),cdt_organic_visits:document.getElementById("cdt_organic_visits"),cdt_total_visits:document.getElementById("cdt_total_visits"),cdt_ad_orders:document.getElementById("cdt_ad_orders"),cdt_organic_orders:document.getElementById("cdt_organic_orders"),cdt_total_orders:document.getElementById("cdt_total_orders"),cdt_ad_cvr:document.getElementById("cdt_ad_cvr"),cdt_organic_cvr:document.getElementById("cdt_organic_cvr"),cdt_total_cvr:document.getElementById("cdt_total_cvr"),cdt_ad_revenue:document.getElementById("cdt_ad_revenue"),cdt_organic_revenue:document.getElementById("cdt_organic_revenue"),cdt_total_revenue:document.getElementById("cdt_total_revenue"),cdt_ad_aov:document.getElementById("cdt_ad_aov"),cdt_organic_aov:document.getElementById("cdt_organic_aov"),cdt_total_aov:document.getElementById("cdt_total_aov"),cdt_ad_revenuePercent:document.getElementById("cdt_ad_revenuePercent"),cdt_organic_revenuePercent:document.getElementById("cdt_organic_revenuePercent"),cdt_ad_ordersPercent:document.getElementById("cdt_ad_ordersPercent"),cdt_organic_ordersPercent:document.getElementById("cdt_organic_ordersPercent")};let D={},L={},N="normal",z="View all",W=new Set;function oe(e){D=e}function re(){return D}function ne(e){L=e}function ie(){return L}function se(e){N=e}function U(){return N}function de(e){z=e}function le(){return z}function ce(e){W.add(e)}function ue(){return W}const A=e=>({USD:"$",EUR:"€",GBP:"£",AUD:"A$",CAD:"C$",DKK:"kr.",HKD:"HK$",INR:"₹",IDR:"Rp",ILS:"₪",JPY:"¥",MYR:"RM",MXN:"MX$",MAD:"د.م.",NZD:"NZ$",NOK:"kr",PHP:"₱",SGD:"S$",ZAR:"R",SEK:"kr",CHF:"CHF",THB:"฿",TRY:"₺",UAH:"₴",VND:"₫"})[e]||e,m=(e,a="USD",o=!1,r=!1)=>{if(isNaN(e)||e===null||!isFinite(e))return r?"":"-";const n=Number(e);if(r)return n.toFixed(2);try{let s=new Intl.NumberFormat(void 0,{style:"currency",currency:a,minimumFractionDigits:2,maximumFractionDigits:2}).format(n);return o&&n>0?`+${s}`:s}catch(d){console.warn("Currency formatting error for code:",a,"- using basic formatting. Error:",d);const s=n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});let l=A(a);const i=["Rp","د.م.","₫","₴","MAD"],c=["DKK","NOK","SEK","CHF","MYR","ZAR","IDR"];let u;return i.includes(a)||typeof l=="string"&&i.includes(l)?u=`${s} ${l}`:c.includes(a)||typeof l=="string"&&c.includes(l)?u=`${l} ${s}`:u=`${l}${s}`,o&&n>0?`+${u}`:u}},_=(e,a=!1)=>isNaN(e)||e===null||!isFinite(e)?a?"":"-":a?Number(e).toFixed(2):`${Number(e).toFixed(2)}%`,g=(e,a=2,o=!1,r="")=>{if(isNaN(e)||e===null||!isFinite(e))return o?"":"-";let n=Number(e).toFixed(a);return o?n:`${n}${r}`},y=(e,a=!1)=>isNaN(e)||e===null||!isFinite(e)?a?"":"-":a?Number(e).toFixed(0):Number(e).toLocaleString("en-US");function me(e,a){let o;return function(...r){clearTimeout(o),o=setTimeout(()=>{e.apply(this,r)},a)}}function pe(e){const a=new Date,o=a.getFullYear(),r=a.getMonth(),n=a.getDate();switch(e){case"today":return 1;case"yesterday":return 1;case"this_month":return n;case"last_month":return new Date(o,r,0).getDate();case"last_30_days":return 30;case"this_year":const d=new Date(o,0,1),s=a.getTime()-d.getTime();return Math.floor(s/(1e3*60*60*24))+1;case"all_time":return 731;default:return console.warn(`Unknown period: ${e}, defaulting to 30 days.`),30}}function ge(e){se(e)}function fe(){const e=t.performancePeriodDropdown.value,a=U();let o=parseFloat(t.totalAdSpend.value)||0,r=parseFloat(t.totalAdRevenue_fromAds.value)||0,n=parseFloat(t.averageProductProfitMargin_percent.value)||0;a==="advanced"&&(t.adv_totalAdSpend&&t.adv_totalAdSpend.value.trim()!==""&&(o=parseFloat(t.adv_totalAdSpend.value)||0),t.adv_totalAdRevenue_fromAds&&t.adv_totalAdRevenue_fromAds.value.trim()!==""&&(r=parseFloat(t.adv_totalAdRevenue_fromAds.value)||0),t.adv_averageProductProfitMargin_percent&&t.adv_averageProductProfitMargin_percent.value.trim()!==""&&(n=parseFloat(t.adv_averageProductProfitMargin_percent.value)||0));const d={totalAdSpend:o,totalAdRevenue_fromAds:r,averageProductProfitMargin_percent:n,adImpressions:parseInt(t.adImpressions.value)||0,adClicks:parseInt(t.adClicks.value)||0,adOrders:parseInt(t.adOrders.value)||0,dailyAdBudget:parseFloat(t.dailyAdBudget.value)||0,performancePeriod_days:pe(e),selectedPeriodString:e,currencyCode:t.currencySymbol.value||"USD",totalOverallShopRevenue:parseFloat(t.totalOverallShopRevenue.value)||0,totalOverallShopOrders:parseInt(t.totalOverallShopOrders.value)||0,totalShopVisits:parseInt(t.totalShopVisits.value)||0,isAdvancedDataAvailable:a==="advanced"&&((parseInt(t.adImpressions.value)||0)>0||(parseInt(t.adClicks.value)||0)>0||(parseInt(t.adOrders.value)||0)>0)};return oe(d),d}function _e(){t.adv_totalAdSpend&&t.totalAdSpend&&(t.adv_totalAdSpend.value=t.totalAdSpend.value),t.adv_totalAdRevenue_fromAds&&t.totalAdRevenue_fromAds&&(t.adv_totalAdRevenue_fromAds.value=t.totalAdRevenue_fromAds.value),t.adv_averageProductProfitMargin_percent&&t.averageProductProfitMargin_percent&&(t.adv_averageProductProfitMargin_percent.value=t.averageProductProfitMargin_percent.value)}function ye(){[{normalId:"totalAdSpend",advancedId:"adv_totalAdSpend"},{normalId:"totalAdRevenue_fromAds",advancedId:"adv_totalAdRevenue_fromAds"},{normalId:"averageProductProfitMargin_percent",advancedId:"adv_averageProductProfitMargin_percent"}].forEach(a=>{const o=t[a.normalId],r=t[a.advancedId];o&&r?(o.addEventListener("input",function(){r.value!==this.value&&(r.value=this.value)}),r.addEventListener("input",function(){o.value!==this.value&&(o.value=this.value)})):(o||console.error(`Error: Input field with ID '${a.normalId}' not found in DOMElements for synchronization.`),r||console.error(`Error: Input field with ID '${a.advancedId}' not found in DOMElements for synchronization.`))})}function ve(e){const a={},o=e.averageProductProfitMargin_percent/100,r=e.adOrders>0?e.totalAdRevenue_fromAds/e.adOrders:0,n=e.totalAdSpend>0?e.totalAdRevenue_fromAds/e.totalAdSpend:0,d=e.totalAdRevenue_fromAds>0?e.totalAdSpend/e.totalAdRevenue_fromAds*100:0,s=e.adOrders>0?e.totalAdSpend/e.adOrders:0,l=e.adClicks>0?e.adOrders/e.adClicks*100:0,c=e.totalAdRevenue_fromAds*o-e.totalAdSpend,u=e.totalAdRevenue_fromAds*(1-o),p=u+e.totalAdSpend,f=e.totalAdRevenue_fromAds>0?c/e.totalAdRevenue_fromAds*100:0;let v="Breakeven";c>.005?v="Profitable":c<-.005&&(v="Unprofitable");const V=o>0?1/o:1/0,T=e.averageProductProfitMargin_percent,I=e.adOrders>0?c/e.adOrders:0,B=e.adImpressions>0?e.adClicks/e.adImpressions*100:0,We=e.adClicks>0?e.totalAdSpend/e.adClicks:0,Ue=e.adImpressions>0?e.totalAdSpend/e.adImpressions*1e3:0,Ye=e.adClicks>0?e.totalAdRevenue_fromAds/e.adClicks:0,qe=e.adClicks>0?c/e.adClicks:0;a.aa_performancePeriod=e.performancePeriod_days,a.aa_selectedPeriodString=e.selectedPeriodString,a.aa_totalAdSpend_sum=e.totalAdSpend,a.aa_totalAdRevenue_sum=e.totalAdRevenue_fromAds,a.aa_adOrders_sum=e.adOrders,a.aa_netAdProfit_sum=c,a.aa_ROAS_kpr=n,a.aa_ACOS_kpr=d,a.aa_CVR_kpr=l,a.aa_CPA_kpr=s,a.aa_totalAdRevenue_prof=e.totalAdRevenue_fromAds,a.aa_totalAdSpend_prof=e.totalAdSpend,a.aa_COGS_prof=u,a.aa_totalCosts_prof=p,a.aa_netProfit_prof=c,a.aa_netProfitMargin_prof=f,a.aa_profitStatus_prof=v,a.aa_ROAS_prof=n,a.aa_breakevenROAS_prof=V,a.aa_ACOS_prof=d,a.aa_breakevenACOS_prof=T,a.aa_adImpressions_eng=e.adImpressions,a.aa_adClicks_eng=e.adClicks,a.aa_CTR_eng=B,a.aa_totalAdSpend_eng=e.totalAdSpend,a.aa_CPC_eng=We,a.aa_CPM_eng=Ue,a.aa_RPC_eng=Ye,a.aa_PPC_eng=qe,a.aa_adOrders_eng=e.adOrders,a.aa_CVR_eng=l,a.aa_AOV_eng=r,a.aa_CPA_eng=s,a.aa_profitPerSale_eng=I;const M=Math.max(0,e.totalOverallShopRevenue-e.totalAdRevenue_fromAds),R=Math.max(0,e.totalOverallShopOrders-e.adOrders),$=Math.max(0,e.totalShopVisits-e.adClicks),te=$>0?R/$*100:0,ae=R>0?M/R:0,He=e.totalOverallShopRevenue*o-e.totalAdSpend;return a.co_blendedROAS=e.totalAdSpend>0?e.totalOverallShopRevenue/e.totalAdSpend:0,a.co_overallShopNetProfitLoss=He,a.co_TACoS_percent=e.totalOverallShopRevenue>0?e.totalAdSpend/e.totalOverallShopRevenue*100:0,a.co_percentRevenueFromAds=e.totalOverallShopRevenue>0?e.totalAdRevenue_fromAds/e.totalOverallShopRevenue*100:0,a.co_percentOrdersFromAds=e.totalOverallShopOrders>0?e.adOrders/e.totalOverallShopOrders*100:0,a.co_organicCVR_forOverview=te,a.co_adCVR_forOverview=l,a.co_organicAOV_forOverview=ae,a.co_adAOV_forOverview=r,a.cdt_ad_visits=e.adClicks,a.cdt_ad_orders=e.adOrders,a.cdt_ad_cvr=l,a.cdt_ad_revenue=e.totalAdRevenue_fromAds,a.cdt_ad_aov=r,a.cdt_ad_revenuePercent=a.co_percentRevenueFromAds,a.cdt_ad_ordersPercent=a.co_percentOrdersFromAds,a.cdt_organic_visits=$,a.cdt_organic_orders=R,a.cdt_organic_cvr=te,a.cdt_organic_revenue=M,a.cdt_organic_aov=ae,a.cdt_organic_revenuePercent=e.totalOverallShopRevenue>0?M/e.totalOverallShopRevenue*100:0,a.cdt_organic_ordersPercent=e.totalOverallShopOrders>0?R/e.totalOverallShopOrders*100:0,a.cdt_total_visits=e.totalShopVisits,a.cdt_total_orders=e.totalOverallShopOrders,a.cdt_total_cvr=e.totalShopVisits>0?e.totalOverallShopOrders/e.totalShopVisits*100:0,a.cdt_total_revenue=e.totalOverallShopRevenue,a.cdt_total_aov=e.totalOverallShopOrders>0?e.totalOverallShopRevenue/e.totalOverallShopOrders:0,a.m_budget_totalBudgetedForPeriod=e.dailyAdBudget*e.performancePeriod_days,a.m_budget_utilization_percent=a.m_budget_totalBudgetedForPeriod>0?e.totalAdSpend/a.m_budget_totalBudgetedForPeriod*100:0,ne(a),a}const E={profitable:{title:"Your Ads Appear Profitable!",description:"Great news! Based on your inputs, for every {currencySymbol}1 you've spent on ads, you're getting back approximately {formattedRoasValueInCurrency}. Your estimated Return on Ad Spend (ROAS) is {roas}x, which is above your breakeven ROAS of {breakevenRoas}x. This has resulted in an estimated net profit of {formattedNetProfit} for this period. Keep up the good work!"},breakeven:{title:"Your Ads Are Around Breakeven",description:"Based on your core inputs, your ads are covering their costs. For every {currencySymbol}1 spent on ads, you're getting back approximately {formattedRoasValueInCurrency}. Your estimated Return on Ad Spend (ROAS) of {roas}x is very close to your breakeven ROAS of {breakevenRoas}x, resulting in an estimated net financial impact of approximately {formattedNetResult} for this period. While not generating significant profit yet, these ads are helping maintain sales activity."},unprofitable:{title:"Your Ads Are Unprofitable",description:"Based on your inputs, it appears your ads might be operating at a loss. For every {currencySymbol}1 spent on ads, you're getting back approximately {formattedRoasValueInCurrency}. Your estimated Return on Ad Spend (ROAS) is {roas}x, which is below your breakeven ROAS of {breakevenRoas}x. This has led to an estimated net loss of {formattedNetLoss} for this period."}},h={slightlyProfitable:{title:"Ads are Barely Profitable",description:"Good progress! Your ads are generating positive returns with a ROAS of {roas}x. Every {currencySymbol}1 spent on advertising brings back {formattedRoasValueInCurrency} in sales. This beats your breakeven target of {breakevenRoas}x by {percentageAboveBreakeven}%, putting you in profitable territory. After covering all advertising costs, your campaigns delivered {formattedNetProfit} net profit this period from {adOrders} orders. You're on the right track, focus on optimizing these campaigns before scaling further. {budgetInsight}",minRequirements:{profit:25,orders:3,spend:75,days:3},roasMultiplier:{min:1.1,max:1.5}},mediumProfitable:{title:"Ads are Profitable!",description:"Excellent results! Your ads are generating strong returns with a ROAS of {roas}x. Every {currencySymbol}1 spent on advertising brings back {formattedRoasValueInCurrency} in sales. This crushes your breakeven target of {breakevenRoas}x by {percentageAboveBreakeven}%! After covering all advertising costs, your campaigns delivered a solid {formattedNetProfit} net profit this period from {adOrders} orders. Your ad strategy is working. {budgetInsight}",minRequirements:{profit:75,orders:5,spend:200,days:5},roasMultiplier:{min:1.5,max:2.5}},highlyProfitable:{title:"Ads are Crushing It!",description:"Outstanding performance! Your ads are delivering exceptional returns with a ROAS of {roas}x. Every {currencySymbol}1 spent on advertising brings back {formattedRoasValueInCurrency} in sales. This absolutely dominates your breakeven target of {breakevenRoas}x by {percentageAboveBreakeven}%! After covering all advertising costs, your campaigns generated an impressive {formattedNetProfit} net profit this period from {adOrders} orders. You've struck gold! {budgetInsight_highlyProfitable}",minRequirements:{profit:200,orders:10,spend:400,days:7},roasMultiplier:{min:2.5,max:1/0}},earlyProfitable:{title:"Ads Show Promise",description:"Early positive signs! Your ads are generating a ROAS of {roas}x, which beats your breakeven target of {breakevenRoas}x by {percentageAboveBreakeven}%. For every {currencySymbol}1 spent, you're getting back {formattedRoasValueInCurrency}. While you've only generated {formattedNetProfit} net profit from {adOrders} orders so far, this performance suggests your campaigns have potential. Continue monitoring for a few more days to confirm this trend before making major budget changes. {budgetInsight_early}",condition:"Good ROAS but doesn't meet minimum thresholds for other profitable tiers"}},C={perfectBreakeven:{title:"Ads Breaking Even",description:"Your current Return on Ad Spend is {roas}x, which is right at your breakeven target of {breakevenRoas}x. With essentially {formattedNetResult} net result this period from {adOrders} orders, your ads are covering their costs. For every {currencySymbol}1 spent, you're getting back {formattedRoasValueInCurrency}. While not generating direct profit, these campaigns are driving valuable sales velocity that can boost your Etsy search rankings organically. Small optimizations could push you into profitable territory. {budgetInsight_breakeven}",minRequirements:{maxAbsResult:25,minSpend:75,minDays:3},roasRange:{min:.95,max:1.05}},slightlyPositiveBreakeven:{title:"Ads Nearly Breaking Even (Slight Profit)",description:"Your current Return on Ad Spend is {roas}x, just above your breakeven target of {breakevenRoas}x by {percentageAboveBreakeven}%. With {formattedNetResult} net profit this period from {adOrders} orders, you're in minimal profit territory. For every {currencySymbol}1 spent, you're getting back {formattedRoasValueInCurrency}. These campaigns are covering costs while generating sales velocity. Focus on small optimizations to improve margins. {budgetInsight_breakeven}",minRequirements:{minResult:10,maxResult:75,minSpend:100,minDays:3},roasRange:{min:1.01,max:1.15}},slightlyNegativeBreakeven:{title:"Ads Nearly Breaking Even (Slight Loss)",description:"Your current Return on Ad Spend is {roas}x, just below your breakeven target of {breakevenRoas}x by {percentageBelowBreakeven}%. With {formattedNetResult} net loss this period from {adOrders} orders, you're very close to covering costs. For every {currencySymbol}1 spent, you're getting back {formattedRoasValueInCurrency}. While not profitable yet, these campaigns are generating sales velocity. Small optimizations should push you into profit. {budgetInsight_breakeven}",minRequirements:{minLoss:10,maxLoss:75,minSpend:100,minDays:3},roasRange:{min:.85,max:.99}},minimalBreakeven:{title:"Early Breakeven Results",description:"Your current Return on Ad Spend is {roas}x, which is close to your breakeven target of {breakevenRoas}x. For every {currencySymbol}1 spent, you're getting back {formattedRoasValueInCurrency}. With minimal financial impact so far ({formattedNetResult} from {adOrders} orders this period), it's still early to draw firm conclusions. These campaigns are generating sales velocity. Continue monitoring while making small optimizations. {budgetInsight_breakeven}",condition:"Close to breakeven but limited data or very small financial impact"}},b={earlyUnprofitable:{title:"Ads in Learning Phase (Loss)",description:"Your current Return on Ad Spend is {roas}x. For every {currencySymbol}1 invested in ads, your campaigns brought back {formattedRoasValueInCurrency} in revenue. This is below the {breakevenRoas}x ROAS needed to break even, resulting in a {formattedNetLoss} net loss this period from {adOrders} orders. Since you're in early testing with modest losses, these campaigns are still generating valuable sales velocity. Review recommendations for optimization. {budgetInsight_unprofitable}",minRequirements:{maxLoss:100,minSpend:50,maxDays:14},roasRange:{min:.6,max:1.1}},slightlyUnprofitable:{title:"Ads Slightly Unprofitable",description:"Your current Return on Ad Spend is {roas}x. For every {currencySymbol}1 invested in ads, your campaigns brought back {formattedRoasValueInCurrency} in revenue. This is just below the {breakevenRoas}x ROAS needed to break even, resulting in a {formattedNetLoss} net loss this period from {adOrders} orders. While not profitable yet, your ads are driving sales velocity. You're close to profitability. {budgetInsight_unprofitable}",minRequirements:{minLoss:50,maxLoss:300,minSpend:100},roasRange:{min:.85,max:1.1}},moderatelyUnprofitable:{title:"Ads Need Optimization (Unprofitable)",description:"Your current Return on Ad Spend is {roas}x. For every {currencySymbol}1 invested in ads, your campaigns brought back only {formattedRoasValueInCurrency} in revenue. This is below the {breakevenRoas}x ROAS needed to break even, resulting in a {formattedNetLoss} net loss this period from {adOrders} orders. Your ads are spending more than they're earning, but this is fixable. {budgetInsight_unprofitable}",minRequirements:{minLoss:100,maxLoss:1e3,minSpend:200},roasRange:{min:.5,max:.85}},severelyUnprofitable:{title:"Ads Losing Significant Money",description:"Your current Return on Ad Spend is {roas}x. For every {currencySymbol}1 invested in ads, your campaigns brought back only {formattedRoasValueInCurrency} in revenue. This is far below the {breakevenRoas}x ROAS needed to break even, resulting in a {formattedNetLoss} net loss this period from {adOrders} orders. These results suggest fundamental issues. {budgetInsight_unprofitable_severe}",minRequirements:{minLoss:300,minSpend:500},roasRange:{min:0,max:.6}},minimalUnprofitable:{title:"Early Testing Results (Loss)",description:"Your current Return on Ad Spend is {roas}x, which is below the {breakevenRoas}x needed to break even, resulting in a {formattedNetLoss} net loss this period from {adOrders} orders. For every {currencySymbol}1 spent, you're getting back {formattedRoasValueInCurrency}. With limited data so far, it's too early to draw firm conclusions. Continue testing. {budgetInsight_unprofitable}",condition:"Small losses or very limited data, not fitting other unprofitable tiers"}};function x(e,a,o,r,n=!1){if(a===0)return o>0?"Daily budget is currently 0. If you are running ads, setting a daily budget helps track utilization and control spend.":"Daily budget not set. Add a daily budget if you plan to run ads to track utilization.";const d=g(e,0);return n?e<80?`Your campaigns are using ${d}% of your budget. Since performance is excellent, consider if you can advertise more listings or refine targeting to help utilize your budget more fully on this profitable traffic.`:`Your campaigns are efficiently using ${d}% of your budget. To scale these fantastic results, you could consider a cautious budget increase.`:r?e<80?`Your campaigns are using ${d}% of your budget. With good performance, explore advertising more listings or ensuring your current ones have broad enough appeal to utilize more of the budget.`:`Your campaigns are using ${d}% of your budget. You could consider a gradual budget increase to capture more sales.`:e>80?`Your campaigns are using ${d}% of your budget. Focus on improving ROAS and core metrics before increasing spend. You might consider reducing the budget while optimizing to limit potential losses.`:`Your campaigns are using ${d}% of your budget. Prioritize optimizing campaign performance to improve profitability before considering budget changes.`}function Ae(e,a,o,r,n,d){if(a===0||!isFinite(a))return"earlyProfitable";const s=e/a,l=h.highlyProfitable;if(s>=l.roasMultiplier.min&&o>=l.minRequirements.profit&&r>=l.minRequirements.orders&&n>=l.minRequirements.spend&&d>=l.minRequirements.days)return"highlyProfitable";const i=h.mediumProfitable;if(s>=i.roasMultiplier.min&&s<l.roasMultiplier.min&&o>=i.minRequirements.profit&&r>=i.minRequirements.orders&&n>=i.minRequirements.spend&&d>=i.minRequirements.days)return"mediumProfitable";const c=h.slightlyProfitable;return s>=c.roasMultiplier.min&&s<i.roasMultiplier.min&&o>=c.minRequirements.profit&&r>=c.minRequirements.orders&&n>=c.minRequirements.spend&&d>=c.minRequirements.days?"slightlyProfitable":o>.005?"earlyProfitable":null}function he(e,a,o,r,n,d){const s=Math.abs(o),l=C.perfectBreakeven;if(e>=l.roasRange.min&&e<=l.roasRange.max&&s<=l.minRequirements.maxAbsResult&&r>=l.minRequirements.minSpend&&n>=l.minRequirements.minDays)return"perfectBreakeven";const i=C.slightlyPositiveBreakeven;if(e>=i.roasRange.min&&e<=i.roasRange.max&&o>=i.minRequirements.minResult&&o<=i.minRequirements.maxResult&&r>=i.minRequirements.minSpend&&n>=i.minRequirements.minDays)return"slightlyPositiveBreakeven";const c=C.slightlyNegativeBreakeven;return e>=c.roasRange.min&&e<=c.roasRange.max&&o<0&&s>=c.minRequirements.minLoss&&s<=c.minRequirements.maxLoss&&r>=c.minRequirements.minSpend&&n>=c.minRequirements.minDays?"slightlyNegativeBreakeven":e>=.85&&e<1.15&&s<50?"minimalBreakeven":null}function be(e,a,o,r,n,d){if(o>=-.005)return null;const s=b.severelyUnprofitable;if(e>=s.roasRange.min&&e<s.roasRange.max&&Math.abs(o)>=s.minRequirements.minLoss&&r>=s.minRequirements.minSpend)return"severelyUnprofitable";const l=b.moderatelyUnprofitable;if(e>=l.roasRange.min&&e<l.roasRange.max&&Math.abs(o)>=l.minRequirements.minLoss&&Math.abs(o)<=l.minRequirements.maxLoss&&r>=l.minRequirements.minSpend)return"moderatelyUnprofitable";const i=b.slightlyUnprofitable;if(e>=i.roasRange.min&&e<i.roasRange.max&&Math.abs(o)>=i.minRequirements.minLoss&&Math.abs(o)<=i.minRequirements.maxLoss&&r>=i.minRequirements.minSpend)return"slightlyUnprofitable";const c=b.earlyUnprofitable;return e>=c.roasRange.min&&e<c.roasRange.max&&Math.abs(o)<=c.minRequirements.maxLoss&&r>=c.minRequirements.minSpend&&n<=c.minRequirements.maxDays?"earlyUnprofitable":"minimalUnprofitable"}function F(e,a){if(!e||!a)return"unknown";const o=e.aa_netAdProfit_sum,r=e.aa_ROAS_kpr,n=e.aa_breakevenROAS_prof;return r!==void 0&&n!==void 0&&n>0&&r<n*.6&&a.totalAdSpend>50&&a.performancePeriod_days>=7?"severelyUnprofitable":o!==void 0&&o>.005?"profitable":o!==void 0&&o<-.005?"unprofitable":o!==void 0?"breakeven":"unknown"}const Ce=[{id:"diveDeeperWithAdvancedMetrics",icon:{name:"magnifying-glass",style:"outline"},iconBgColor:"#475569",category:"Strategy & Insights",priority:100,noDismiss:!1,badgeText:"Deeper Insights",title:"Unlock Advanced Recommendations",descriptionFunction:(e,a)=>"You're viewing a summary based on core inputs. For more tailored recommendations and a complete understanding of your ad performance (like Click-Through Rate, Conversion Rate, and Cost Per Click), switch to 'Advanced View' and provide detailed ad data.",action:{label:"Switch to Advanced View",type:"function_call",target:"toggleAdvancedView"},condition:(e,a,o)=>o==="normal"},{id:"optimizeAdvertisedListingsWithAlura",icon:{name:"sparkles",style:"outline"},iconBgColor:"#4B5563",category:"Ad Performance",priority:90,noDismiss:!1,badgeText:"Increase ROAS",title:"Turn Off Underperforming Listings",descriptionFunction:(e,a)=>{const o=F(a,e);return o==="profitable"?"Your ads are generally performing well! To further boost your ROAS, use the Ads Optimizer to automatically identify and pause any individual listings that might be underperforming (e.g., low ROAS or high spend with few sales) within your successful campaigns. This ensures your budget is concentrated on the absolute top performers.":o==="breakeven"?"Some of your ads are just covering costs. The Ads Optimizer can help identify and pause listings that aren't quite hitting profitability or those spending without sales, freeing up budget for better performers.":"Improve your ad efficiency. The Ads Optimizer can automatically pause underperforming listings (e.g., those with high spend and no sales, or ROAS below breakeven) to redirect your budget towards what works and help refocus your strategy."},action:{label:"Use Ads Optimizer",type:"link",target:"https://app.alura.io/marketing/etsy-ads"},condition:(e,a)=>!0},{id:"optimizeAdBudgetToPerformance",icon:{name:"adjustments-horizontal",style:"outline"},iconBgColor:"#52525B",category:"Budget & Profit",priority:86,noDismiss:!1,badgeText:"Ad Spend Flow",title:"Adjust Your Ad Budget",descriptionFunction:(e,a)=>{const o=a.m_budget_utilization_percent,r=e.performancePeriod_days>0?e.totalAdSpend/e.performancePeriod_days:0,n=e.dailyAdBudget||0,d=e.currencySymbolPlaceholder||A(e.currencyCode)||"$",s=a.aa_ROAS_kpr,l=a.aa_breakevenROAS_prof;let i="breakeven";if(s!==void 0&&l!==void 0&&l>0?s>l*1.1?i="profitable":s<l*.9&&(i="unprofitable"):s!==void 0&&(l===0||l===void 0||!isFinite(l))&&s>0&&(i="profitable"),n===0&&e.totalAdSpend>0)return`You've spent ${d}${e.totalAdSpend.toFixed(2)} on ads, but your daily budget isn't set in Alura. To get precise budget utilization insights, please enter your Etsy daily ad budget.`;if(n===0)return"Enter your daily ad budget (as set on Etsy) to analyze how effectively your budget is being used.";const c=s!==void 0?s.toFixed(2)+"x":"N/A",u=`${d}${n.toFixed(2)}`,p=o!==void 0?o.toFixed(0)+"%":"N/A",f=`${d}${r.toFixed(2)}`;return o<70&&e.performancePeriod_days>3?i==="profitable"?`Your ads are profitable (ROAS: ${c}) but only using about ${p} of your ${u} daily budget. This is a missed sales opportunity! Consider advertising more well-optimized listings or ensuring current ones have broad appeal to help Etsy spend your budget on these winning ads.`:i==="unprofitable"?`Your ads are underperforming (ROAS: ${c}) and using about ${p} of your ${u} daily budget. While underspending limits current losses, your primary focus should be improving ad ROAS (optimizing listings, targeting) before attempting to increase spend.`:`Your ads are near breakeven (ROAS: ${c}), using about ${p} of your ${u} daily budget. Monitor closely: if ROAS improves, you'll want Etsy to spend more. If not, the current underspend is somewhat protective. Aim for consistent profitability first.`:o>115?i==="profitable"?`Great! Your ads are profitable (ROAS: ${c}) and Etsy is effectively spending slightly over your ${u} daily budget (approx. ${f}/day). Consider increasing your daily budget on Etsy to capture all available profitable sales.`:`Warning: Your ads are spending ${f}/day, exceeding your ${u} budget, but performance is poor (ROAS: ${c}). This accelerates losses. Urgently review your Etsy ad campaigns; consider reducing the budget or pausing ads with the lowest ROAS.`:i==="profitable"?`Your ads are profitable (ROAS: ${c}) and utilizing your budget well (approx. ${p} of ${u} daily). This is healthy. If consistently strong, you could test a small budget increase on Etsy for more sales.`:i==="unprofitable"?`Your ads are using your budget (approx. ${p} of ${u} daily) but are notably unprofitable (ROAS: ${c}). Focus on improving ROAS by optimizing listings or targeting. Spending your full budget on underperforming ads will reduce overall profit.`:`Your ads are spending well (approx. ${p} of ${u} daily) but are around breakeven (ROAS: ${c}). Prioritize optimizations to achieve clear profitability before considering any budget increases. Monitor which specific listings are performing best.`},action:{label:"Adjust Ads on Etsy",type:"link",target:"https://www.etsy.com/your/shops/me/advertising"},condition:(e,a,o)=>e.isAdvancedDataAvailable&&e.performancePeriod_days>1&&e.dailyAdBudget!==void 0},{id:"alertHighSpendZeroAdOrders",icon:{name:"exclamation-triangle",style:"solid"},iconBgColor:"#525252",category:"Budget & Profit",priority:96,noDismiss:!1,badgeText:"Sales Alert",title:"Ad Spend Without Sales",descriptionFunction:(e,a)=>{const o=e.currencySymbolPlaceholder||A(e.currencyCode)||"$",r=e.adClicks||0,n=(e.totalAdSpend||0).toFixed(2);return`You've spent ${o}${n} on ads, receiving ${r} clicks, but recorded zero orders directly from these ads. This requires immediate investigation. Review which listings are advertised, their pricing, shipping, photo quality, and overall content. Also, check the keyword relevance of your listing's tags and titles for items consuming the most ad spend, as mismatches can lead to costly, irrelevant clicks. It's advisable to review your Etsy Ads Dashboard now to identify which specific listings are spending without converting.`},action:{label:"Review Problem Ads",type:"link",target:"https://www.etsy.com/your/shops/me/advertising/listings"},condition:(e,a,o)=>e.isAdvancedDataAvailable&&e.totalAdSpend>100&&e.adOrders===0&&e.adClicks>10},{id:"analyzeTACOSAndSalesVelocity",icon:{name:"receipt-percent",style:"outline"},iconBgColor:"#57534E",category:"Strategy & Insights",priority:80,noDismiss:!1,badgeText:"Shop Profit Health",title:"Check Your Overall Shop Profit",descriptionFunction:(e,a)=>{const o=a.co_TACoS_percent!==void 0?a.co_TACoS_percent.toFixed(2):"N/A",r=a.co_percentRevenueFromAds!==void 0?a.co_percentRevenueFromAds.toFixed(1):"N/A",n=e.averageProductProfitMargin_percent||0,d=e.currencySymbolPlaceholder||A(e.currencyCode)||"$";return o==="N/A"||r==="N/A"||!e.totalOverallShopRevenue||e.totalOverallShopRevenue===0?"To evaluate how your ads contribute to overall sales and shop velocity, please ensure your 'Shop Stats Data' (total shop visits, orders, revenue) is entered for the same performance period. This unlocks your Total Advertising Cost of Sale (TACoS) insight.":`Ads drive ${r}% of your sales, and your TACoS (Total Ad Cost of Sale) is ${o}%. This ${o}% is your ad investment per ${d}100 of total shop revenue. Crucially, for overall shop profitability, this TACoS should be comfortably below your average ${n}% profit margin. Achieving this balance also typically boosts sales velocity, which can aid your organic search ranking.`},action:{label:"Analyze Shop Stats",type:"link",target:"https://app.alura.io/analytics/financial-reports"},condition:(e,a,o)=>e.isAdvancedDataAvailable&&e.totalOverallShopRevenue>0&&e.totalOverallShopOrders>0&&e.totalShopVisits>0&&a.co_TACoS_percent!==void 0&&a.co_percentRevenueFromAds!==void 0},{id:"setAdequateTestBudget",icon:{name:"beaker",style:"outline"},iconBgColor:"#EA580C",category:"Budget & Profit",priority:84,noDismiss:!1,badgeText:"Effective Testing",title:"Set Adequate Budget for Ad Testing",descriptionFunction:(e,a)=>{const o=e.currencySymbolPlaceholder||A(e.currencyCode)||"$";return`Effective ad testing often requires a sufficient daily budget. If your current budget is very low (e.g., under ${o}5) and your ads aren't severely unprofitable, consider setting it to at least ${o}5 on Etsy. This gives your ads a better chance to gather enough data for performance evaluation and for Etsy's algorithm to optimize delivery.`},action:{label:"Manage Budget on Etsy",type:"link",target:"https://www.etsy.com/your/shops/me/advertising"},condition:(e,a)=>{const o=F(a,e);return e.dailyAdBudget>0&&e.dailyAdBudget<5&&o!=="severelyUnprofitable"}},{id:"considerPausingAds",icon:{name:"pause-circle",style:"solid"},iconBgColor:"#CA8A04",category:"Budget & Profit",priority:95,noDismiss:!1,badgeText:"Minimize Losses",title:"Review Unprofitable Ads",descriptionFunction:(e,a)=>`Your ads are significantly unprofitable with a ROAS of ${a.aa_ROAS_kpr!==void 0&&isFinite(a.aa_ROAS_kpr)?a.aa_ROAS_kpr.toFixed(2):"N/A"}x. If this trend has persisted for over 7-14 days with sufficient spend (e.g., > $50-$100), consider pausing all ads via your Etsy dashboard to prevent further losses while you thoroughly re-evaluate your strategy.`,action:{label:"Go to Etsy Ads to Pause",type:"link",target:"https://www.etsy.com/your/shops/me/advertising"},condition:(e,a)=>{const o=a.aa_ROAS_kpr,r=a.aa_breakevenROAS_prof;return e.isAdvancedDataAvailable&&o!==void 0&&r!==void 0&&r>0&&o<r*.6&&e.totalAdSpend>50&&e.performancePeriod_days>=7}},{id:"focusOnHighPotentialListings",icon:{name:"star",style:"solid"},iconBgColor:"#65A30D",category:"Ad Performance",priority:75,noDismiss:!1,badgeText:"Maximize Winners",title:"Prioritize Top Listings for Ads",descriptionFunction:(e,a)=>"Some of your listings naturally perform better or have higher optimization scores. Consider focusing more of your ad budget on these high-potential items first, as they are more likely to convert profitably. You can identify these through Listing Analytics.",action:{label:"View Listing Analytics",type:"link",target:"https://app.alura.io/analytics/listings?filter=top-sellers"},condition:(e,a,o)=>e.isAdvancedDataAvailable&&e.dailyAdBudget>0&&e.dailyAdBudget<20&&e.totalAdSpend>20},{id:"advertiseAllInitially",icon:{name:"light-bulb",style:"outline"},iconBgColor:"#16A34A",category:"Strategy & Insights",priority:78,noDismiss:!1,badgeText:"Discover Winners",title:"Test All Listings Initially",descriptionFunction:(e,a)=>"When starting with Etsy Ads, or if you've added many new products, consider advertising all (or most) of your listings with a modest budget (e.g., $5-$10/day). This allows you to gather data on which items perform best with ads, helping you discover unexpected winners before narrowing your focus.",action:{label:"Manage Advertised Listings on Etsy",type:"link",target:"https://www.etsy.com/your/shops/me/advertising/listings"},condition:(e,a,o)=>(!e.isAdvancedDataAvailable||o==="normal")&&(e.totalAdSpend<50&&e.performancePeriod_days<=30||e.dailyAdBudget>0&&e.dailyAdBudget<=5)},{id:"discoverNewAdKeywords",icon:{name:"key",style:"outline"},iconBgColor:"#059669",category:"Strategy & Insights",priority:68,noDismiss:!1,badgeText:"Expand Reach",title:"Find New Ad Keywords",descriptionFunction:(e,a)=>"Your Etsy Ads are only as good as your listing tags. Since tags determine where your ads appear, optimizing them is key. Use the Keyword Finder to discover high-demand, relevant terms that can significantly improve your ad targeting and attract more buyers.",action:{label:"Find Keywords",type:"link",target:"https://app.alura.io/keyword-finder"},condition:(e,a,o)=>e.isAdvancedDataAvailable},{id:"reviewProfitabilityPerProduct",icon:{name:"currency-dollar",style:"outline"},iconBgColor:"#0D9488",category:"Budget & Profit",priority:82,noDismiss:!1,badgeText:"Profit Check",title:"Know Your Product Profit",descriptionFunction:(e,a)=>"Not all products have the same profit margin. Before heavily advertising a listing, use the Profit Calculator to understand its true profitability after all fees and ad costs. This helps ensure your ads are actually making you money on each sale.",action:{label:"Calculate Product Profit",type:"link",target:"https://app.alura.io/resources/calculator"},condition:(e,a)=>{const o=F(a,e);return o==="breakeven"||e.isAdvancedDataAvailable&&(o==="profitable"||o==="unprofitable")}},{id:"addressLowAdCVR",icon:{name:"cursor-arrow-rays",style:"outline"},iconBgColor:"#0891B2",category:"Ad Performance",priority:88,noDismiss:!1,badgeText:"Boost Sales",title:"Improve Ad Conversion Rate",descriptionFunction:(e,a)=>{if(e.isAdvancedDataAvailable&&a.aa_CVR_kpr!==void 0){const o=a.aa_CVR_kpr.toFixed(2);if(a.aa_CVR_kpr<1&&e.adClicks>20)return`Your ad Conversion Rate (CVR) is ${o}%, which is quite low. This means people click your ads but aren't buying. Focus on optimizing your listing pages: improve photos, clarify descriptions, check pricing, and ensure shipping is competitive. A/B testing can help pinpoint what to change.`;if(a.aa_CVR_kpr<2.5&&e.adClicks>10)return`Your ad Conversion Rate (CVR) is ${o}%. There's room for improvement! Review your listing pages for areas to enhance buyer confidence, such as detailed descriptions, multiple high-quality images/video, and clear policies. Consider A/B testing different elements.`}return"Ensure your product pages are fully optimized to turn ad clicks into sales. High-quality photos, clear descriptions, competitive pricing, and reasonable shipping are key to improving your Conversion Rate."},action:{label:"A/B Test Listing Elements",type:"link",target:"https://app.alura.io/operations/ab-tests"},condition:(e,a,o)=>e.isAdvancedDataAvailable&&a.aa_CVR_kpr!==void 0&&e.adClicks>10&&a.aa_CVR_kpr<2.5},{id:"addVideosToBoostCTR",icon:{name:"video-camera",style:"outline"},iconBgColor:"#0284C7",category:"Ad Performance",priority:70,noDismiss:!1,badgeText:"Increase CTR",title:"Add Listing Videos",descriptionFunction:(e,a)=>{let o="Listings with videos can get up to 2x more sales on Etsy and tend to increase Click-Through Rates (CTR) as they auto-play on hover. ";if(e.isAdvancedDataAvailable&&a.aa_CTR_eng!==void 0){const r=a.aa_CTR_eng.toFixed(2);a.aa_CTR_eng<1?o=`Your current average ad Click-Through Rate (CTR) is ${r}%. Improving this can bring more potential buyers. Listings with videos often see higher engagement. `:o=`Your average ad Click-Through Rate (CTR) is ${r}%. To potentially boost this further, consider adding videos. `}return o+"Use the 1-click video generator to easily add videos to your advertised listings and enhance their appeal."},action:{label:"Create Listing Videos",type:"link",target:"https://app.alura.io/optimization/listings?filter=missing-video"},condition:(e,a)=>!0},{id:"abTestPrimaryImageForCTR",icon:{name:"photo",style:"outline"},iconBgColor:"#2563EB",category:"Ad Performance",priority:65,noDismiss:!1,badgeText:"Improve CTR",title:"A/B Test Primary Images",descriptionFunction:(e,a)=>{let o="Your primary image is crucial for attracting clicks. ";if(e.isAdvancedDataAvailable&&a.aa_CTR_eng!==void 0){const r=a.aa_CTR_eng.toFixed(2);o+=`Your current ad CTR is ${r}%. `}return o+="Use A/B Testing to experiment with different primary images for your key advertised listings to find out what captures more attention and boosts your CTR.",o},action:{label:"Start A/B Test",type:"link",target:"https://app.alura.io/operations/ab-tests"},condition:(e,a)=>!0},{id:"abTestPricingForCVR",icon:{name:"tag",style:"outline"},iconBgColor:"#4F46E5",category:"Ad Performance",priority:60,noDismiss:!1,badgeText:"Boost CVR",title:"A/B Test Listing Prices",descriptionFunction:(e,a)=>{let o="Price is a major factor in a buyer's decision. ";if(e.isAdvancedDataAvailable&&a.aa_CVR_kpr!==void 0){const r=a.aa_CVR_kpr.toFixed(2);a.aa_CVR_kpr<2&&a.aa_CVR_kpr>0?o+=`Your current ad Conversion Rate (CVR) is ${r}%. `:a.aa_CVR_kpr===0&&e.adClicks>10&&(o+=`Your ads are getting clicks but not converting (CVR: ${r}%). `)}return o+="Use A/B Testing to experiment with different price points for your advertised listings. This can help you find the sweet spot that maximizes sales and profit.",o},action:{label:"Start A/B Test",type:"link",target:"https://app.alura.io/operations/ab-tests"},condition:(e,a)=>!0},{id:"optimizeAdKeywordsInEtsy",icon:{name:"wrench-screwdriver",style:"outline"},iconBgColor:"#7C3AED",category:"Strategy & Insights",priority:80,noDismiss:!1,badgeText:"Refine Targeting",title:"Optimize Ad Keywords",descriptionFunction:(e,a)=>{let o="Review the 'Detailed stats' for your advertised listings on Etsy. ";const r=e.currencySymbolPlaceholder||A(e.currencyCode)||"$";return e.isAdvancedDataAvailable&&e.totalAdSpend>0&&(o+=`You've spent ${r}${e.totalAdSpend.toFixed(2)} on ads. `),o+="Identify search terms (keywords) that are driving clicks but have low sales or a ROAS below your breakeven point. Consider pausing these specific keywords within Etsy's ad dashboard to focus your budget on terms that convert profitably. Start by checking listings with the highest ad spend.",o},action:{label:"View Etsy Ads Listing Stats",type:"link",target:"https://www.etsy.com/your/shops/me/advertising/listings"},condition:(e,a)=>e.isAdvancedDataAvailable&&e.totalAdSpend>10}];function Se(e,a,o,r=new Set){return!e||!a?[]:Ce.filter(n=>{if(r.has(n.id)&&!n.noDismiss)return!1;try{return typeof n.condition=="function"?n.condition(e,a,o):!0}catch(d){return console.error(`Error evaluating condition for recommendation '${n.id}':`,d),!1}})}function Re(e,a){const o=e.aa_netAdProfit_sum,r=e.aa_ROAS_kpr,n=e.aa_breakevenROAS_prof,d=a.currencyCode,s=A(d),l=r;let i={title:"Performance Analysis",description:"Enter your ad data to see detailed insights.",statusClass:"neutral"};if(!a.isAdvancedDataAvailable)o>.005?i={...E.profitable,statusClass:"profitable"}:o<-.005?i={...E.unprofitable,statusClass:"not-profitable"}:i={...E.breakeven,statusClass:"breaking-even"},i.description=i.description.replace(/{currencySymbol}/g,s).replace(/{formattedRoasValueInCurrency}/g,m(l,d)).replace(/{roas}/g,g(r,2,!1,"")).replace(/{breakevenRoas}/g,isFinite(n)?g(n,2,!1,""):"N/A").replace(/{formattedNetProfit}/g,m(o,d,!0)).replace(/{formattedNetResult}/g,m(o,d,!0)).replace(/{formattedNetLoss}/g,m(o,d,!0));else{const c=e.m_budget_utilization_percent,u=a.adOrders;let p=null;if(o>.005){if(p=Ae(r,n,o,u,a.totalAdSpend,a.performancePeriod_days),p&&h[p]){const f=h[p],v=x(c,a.dailyAdBudget,a.totalAdSpend,!0,p==="highlyProfitable");i.title=f.title,i.description=f.description.replace(/{roas}/g,g(r,2,!1,"")).replace(/{currencySymbol}/g,s).replace(/{formattedRoasValueInCurrency}/g,m(l,d)).replace(/{breakevenRoas}/g,isFinite(n)?g(n,2,!1,""):"N/A").replace(/{percentageAboveBreakeven}/g,n>0&&isFinite(n)?y(Math.round((r/n-1)*100)):"0").replace(/{formattedNetProfit}/g,m(o,d,!0)).replace(/{adOrders}/g,y(u)).replace(/{budgetInsight}/g,v).replace(/{budgetInsight_highlyProfitable}/g,v).replace(/{budgetInsight_early}/g,v),i.statusClass="profitable"}}else if(o<-.005){if(p=be(r,n,o,a.totalAdSpend,a.performancePeriod_days),p&&b[p]){const f=b[p],v=x(c,a.dailyAdBudget,a.totalAdSpend,!1);i.title=f.title,i.description=f.description.replace(/{roas}/g,g(r,2,!1,"")).replace(/{currencySymbol}/g,s).replace(/{formattedRoasValueInCurrency}/g,m(l,d)).replace(/{breakevenRoas}/g,isFinite(n)?g(n,2,!1,""):"N/A").replace(/{formattedNetLoss}/g,m(o,d,!0)).replace(/{adOrders}/g,y(u)).replace(/{budgetInsight_unprofitable}/g,v).replace(/{budgetInsight_unprofitable_severe}/g,v),i.statusClass="not-profitable"}}else if(p=he(r,n,o,a.totalAdSpend,a.performancePeriod_days),p&&C[p]){const f=C[p],v=x(c,a.dailyAdBudget,a.totalAdSpend,!1);i.title=f.title,i.description=f.description.replace(/{roas}/g,g(r,2,!1,"")).replace(/{currencySymbol}/g,s).replace(/{formattedRoasValueInCurrency}/g,m(l,d)).replace(/{breakevenRoas}/g,isFinite(n)?g(n,2,!1,""):"N/A").replace(/{formattedNetResult}/g,m(o,d,!0)).replace(/{adOrders}/g,y(u)).replace(/{percentageAboveBreakeven}/g,n>0&&isFinite(n)&&r>n?y(Math.round((r/n-1)*100)):"0").replace(/{percentageBelowBreakeven}/g,n>0&&isFinite(n)&&r<n?y(Math.round((1-r/n)*100)):"0").replace(/{budgetInsight_breakeven}/g,v),i.statusClass="breaking-even"}if(!p||i.title==="Performance Analysis"){const f=x(e.m_budget_utilization_percent,a.dailyAdBudget,a.totalAdSpend,o>.005,o>.005&&r>h.mediumProfitable.roasMultiplier.min*(isFinite(n)&&n>0?n:1.5));o>.005?(i.title="Ads Profitable (General)",i.description=`Your ads are profitable with a ROAS of ${g(r,2,!1,"x")} and net profit of ${m(o,d,!0)}. Review detailed metrics for more insights. ${f}`,i.statusClass="profitable"):o<-.005?(i.title="Ads Unprofitable (General)",i.description=`Your ads are unprofitable with a ROAS of ${g(r,2,!1,"x")} and net loss of ${m(o,d,!0)}. Review detailed metrics to identify areas for improvement. ${f}`,i.statusClass="not-profitable"):(i.title="Ads Breaking Even (General)",i.description=`Your ads are breaking even with a ROAS of ${g(r,2,!1,"x")}. ${f}`,i.statusClass="breaking-even")}}return i}const xe="https://cdn.jsdelivr.net/npm/heroicons@2.1.3/24/",S={},Pe=3,Oe=1e3,Y=5;async function P(e,a,o=0){const r='<svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" /></svg>',n='<svg viewBox="0 0 24 24" fill="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg>';if(!e||!a)return r;const d=`${e}-${a}`;if(S[d])return S[d];try{const l=localStorage.getItem(`icon-${d}`);if(l)return S[d]=l,l}catch(l){console.warn("localStorage access failed:",l)}const s=`${xe}${a}/${e}.svg`;try{const l=await fetch(s);if(!l.ok)throw new Error(`Failed to fetch icon: ${l.status}`);const i=await l.text();S[d]=i;try{localStorage.setItem(`icon-${d}`,i)}catch(c){console.warn("Failed to cache icon in localStorage:",c)}return i}catch(l){return console.error(`Error fetching icon ${e} (${a}):`,l),o<Pe?(await new Promise(i=>setTimeout(i,Oe*(o+1))),P(e,a,o+1)):n}}const q={diveDeeperWithAdvancedMetrics:{name:"magnifying-glass",style:"outline"},optimizeAdvertisedListingsWithAlura:{name:"sparkles",style:"outline"},optimizeAdBudgetToPerformance:{name:"adjustments-horizontal",style:"outline"},alertHighSpendZeroAdOrders:{name:"exclamation-triangle",style:"solid"},analyzeTACOSAndSalesVelocity:{name:"receipt-percent",style:"outline"},setAdequateTestBudget:{name:"beaker",style:"outline"},considerPausingAds:{name:"pause-circle",style:"solid"},focusOnHighPotentialListings:{name:"star",style:"solid"},advertiseAllInitially:{name:"light-bulb",style:"outline"},discoverNewAdKeywords:{name:"key",style:"outline"},reviewProfitabilityPerProduct:{name:"currency-dollar",style:"outline"},addressLowAdCVR:{name:"cursor-arrow-rays",style:"outline"},addVideosToBoostCTR:{name:"video-camera",style:"outline"},abTestPrimaryImageForCTR:{name:"photo",style:"outline"},abTestPricingForCVR:{name:"tag",style:"outline"},optimizeAdKeywordsInEtsy:{name:"wrench-screwdriver",style:"outline"}};async function we(){console.log("Starting icon preloading...");const e=[];for(const a in q){const o=q[a];if(o&&o.name&&o.style){const r=`${o.name}-${o.style}`;if(!S[r]){let n=!1;try{localStorage.getItem(`icon-${r}`)&&(n=!0)}catch{}n||e.push({name:o.name,style:o.style})}}}for(let a=0;a<e.length;a+=Y){const r=e.slice(a,a+Y).map(n=>P(n.name,n.style).catch(d=>{console.error(`Error preloading icon ${n.name}-${n.style}:`,d)}));await Promise.allSettled(r)}console.log("Icon preloading complete.")}function ke(e){return e.currencySymbolPlaceholder||A(e.currencyCode)||"$"}async function H(e,a,o,r,n,d){if(!t.recommendationsSection)return;const s=Se(e,a,o,n);Te(s,r,d.onFilterClick);const l=r==="View all"||!r?s:s.filter(i=>i.category===r);if(await Ie(l,e,a,d.onActionClick,d.onDismissClick),t.recommendationsEmptyState&&t.recommendationOutputArea){const i=t.recommendationOutputArea.hasChildNodes();l.length>0&&i?(t.recommendationsEmptyState.style.display="none",t.recommendationOutputArea.style.display="block"):(t.recommendationsEmptyState.style.display="flex",t.recommendationOutputArea.style.display="none",s.length===0&&t.categoryFilters&&(t.categoryFilters.innerHTML=""))}}function Te(e,a,o){if(!t.categoryFilters||(t.categoryFilters.innerHTML="",e.length===0))return;const r=new Set;e.forEach(s=>{s.category&&r.add(s.category)});const n=(s,l=!1)=>{const i=document.createElement("button");i.textContent=s,i.className="filter-badge-base";const c=l?a==="View all"||!a:a===s;i.classList.add(c?"filter-badge-active":"filter-badge-inactive"),i.dataset.category=s,i.addEventListener("click",()=>o(s)),t.categoryFilters.appendChild(i)};n("View all",!0),["Budget & Profit","Ad Performance","Strategy & Insights"].forEach(s=>{r.has(s)&&n(s)})}async function Ie(e,a,o,r,n){if(t.recommendationOutputArea&&(t.recommendationOutputArea.innerHTML="",e.length!==0))for(const d of e){const s=document.createElement("div");s.className="recommendation-card-wrapper bg-p-gray-25 border border-p-gray-200 rounded-xl shadow-custom-xs";const l=typeof d.titleFunction=="function"?d.titleFunction(a,o):d.title;let i=typeof d.descriptionFunction=="function"?d.descriptionFunction(a,o):d.description||"";const c=typeof d.badgeTextFunction=="function"?d.badgeTextFunction(a,o):d.badgeText||"",u=ke(a);i=i.replace(/{currencySymbol}/g,u),o&&o.aa_ROAS_kpr!==void 0&&(i=i.replace(/{roas}x/g,`${g(o.aa_ROAS_kpr,2)}x`),i=i.replace(/{roas}/g,g(o.aa_ROAS_kpr,2))),o&&o.aa_CTR_eng!==void 0&&(i=i.replace(/{CTR}/g,g(o.aa_CTR_eng,2))),o&&o.aa_CVR_kpr!==void 0&&(i=i.replace(/{CVR}/g,g(o.aa_CVR_kpr,2)));const p=d.icon;let f="";p&&typeof P=="function"?f=await P(p.name,p.style):f='<svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" /></svg>';const V=`<div class="icon-display" style="--icon-bg-color: ${d.iconBgColor||"#667085"};">${f}</div>`;let T="";if(d.action&&(T=`
                <div class="p-4 border-t border-p-gray-200 flex justify-end items-center space-x-4">
                    ${d.noDismiss?"":`<button class="text-sm font-semibold text-p-gray-600 hover:text-p-gray-700 active:text-p-gray-800 transition-colors duration-200" data-rec-id="${d.id}" data-action-type="dismiss">Dismiss</button>`}
                    <button class="text-sm font-semibold text-p-primary-700 hover:text-p-primary-600 active:text-p-primary-800 transition-colors duration-200" data-rec-id="${d.id}" data-action-type="primary" data-action-kind="${d.action.type}" data-action-target="${d.action.target}">${d.action.label}</button>
                </div>`),s.innerHTML=`
            <div class="px-4 py-5">
                <div class="flex items-start space-x-3 items-center">
                    ${V}
                    <div class="flex-grow">
                        <div class="flex items-center space-x-2 mb-1">
                            <h5 class="text-base font-medium text-p-gray-900">${l}</h5>
                            ${c?`<span class="recommendation-title-badge-style">${c}</span>`:""}
                        </div>
                    </div>
                </div>
                <div class="mt-2">
                    <p class="text-sm text-p-gray-600">${i}</p>
                </div>
            </div>
            ${T}
        `,d.action){const I=s.querySelector('button[data-action-type="dismiss"]');I&&I.addEventListener("click",()=>n(d.id));const B=s.querySelector('button[data-action-type="primary"]');B&&B.addEventListener("click",()=>r(d.id,d.action.type,d.action.target))}t.recommendationOutputArea.appendChild(s)}}function Be(e,a,o){const r=a.currencyCode;t.roasStatValue&&(t.roasStatValue.textContent=g(e.aa_ROAS_kpr,2,!1,"x")),t.breakevenRoasStatValue&&(t.breakevenRoasStatValue.textContent=isFinite(e.aa_breakevenROAS_prof)?g(e.aa_breakevenROAS_prof,2,!1,"x"):"-"),t.netAdProfitStatValue&&(t.netAdProfitStatValue.textContent=m(e.aa_netAdProfit_sum,r,!0));const n=Re(e,a);if(t.profitabilityMessageTitle&&(t.profitabilityMessageTitle.textContent=n.title),t.profitabilityMessageText&&(t.profitabilityMessageText.innerHTML=n.description),t.profitabilityStatusBadge){const s=t.profitabilityStatusBadge;s.textContent=n.statusClass.charAt(0).toUpperCase()+n.statusClass.slice(1).replace("-"," ");const l="inline-flex items-center whitespace-nowrap mix-blend-multiply rounded-full min-h-[22px] px-[7px] py-px text-xs leading-18px gap-x-1.5";n.statusClass==="profitable"?s.className=`${l} border border-p-success-200 bg-p-success-50 text-p-success-700`:n.statusClass==="not-profitable"?s.className=`${l} border border-p-error-200 bg-p-error-50 text-p-error-700`:n.statusClass==="breaking-even"?s.className=`${l} border border-p-warning-200 bg-p-warning-50 text-p-warning-700`:s.className=`${l} border border-p-gray-200 bg-p-gray-50 text-p-gray-700`,s.classList.remove("hidden")}if(t.profitabilityMessageCard){const s=t.profitabilityMessageCard,l="p-4 rounded-lg mt-4 shadow-custom-xs";n.statusClass==="profitable"?s.className=`${l} bg-p-success-25 border border-p-success-200 text-p-success-700`:n.statusClass==="not-profitable"?s.className=`${l} bg-p-error-25 border border-p-error-200 text-p-error-700`:n.statusClass==="breaking-even"?s.className=`${l} bg-p-warning-25 border border-p-warning-200 text-p-warning-700`:s.className=`${l} bg-p-gray-25 border border-p-gray-200 text-p-gray-700`}if(t.performancePeriodDropdown&&t.aa_performancePeriod){const s=t.performancePeriodDropdown.options[t.performancePeriodDropdown.selectedIndex]?.text||"Selected Period";t.aa_performancePeriod.textContent=`${s} (${y(e.aa_performancePeriod)} days)`}if(t.aa_totalAdSpend_sum&&(t.aa_totalAdSpend_sum.textContent=m(e.aa_totalAdSpend_sum,r)),t.aa_totalAdRevenue_sum&&(t.aa_totalAdRevenue_sum.textContent=m(e.aa_totalAdRevenue_sum,r)),t.aa_adOrders_sum&&(t.aa_adOrders_sum.textContent=y(e.aa_adOrders_sum)),t.aa_netAdProfit_sum&&(t.aa_netAdProfit_sum.textContent=m(e.aa_netAdProfit_sum,r,!0)),t.aa_ROAS_kpr&&(t.aa_ROAS_kpr.textContent=g(e.aa_ROAS_kpr,2,!1,"x")),t.aa_ACOS_kpr&&(t.aa_ACOS_kpr.textContent=_(e.aa_ACOS_kpr)),t.aa_CVR_kpr&&(t.aa_CVR_kpr.textContent=_(e.aa_CVR_kpr)),t.aa_CPA_kpr&&(t.aa_CPA_kpr.textContent=m(e.aa_CPA_kpr,r)),t.aa_totalAdRevenue_prof&&(t.aa_totalAdRevenue_prof.textContent=m(e.aa_totalAdRevenue_prof,r)),t.aa_totalAdSpend_prof&&(t.aa_totalAdSpend_prof.textContent=m(e.aa_totalAdSpend_prof,r)),t.aa_COGS_prof&&(t.aa_COGS_prof.textContent=m(e.aa_COGS_prof,r)),t.aa_totalCosts_prof&&(t.aa_totalCosts_prof.textContent=m(e.aa_totalCosts_prof,r)),t.aa_netProfit_prof&&(t.aa_netProfit_prof.textContent=m(e.aa_netProfit_prof,r,!0)),t.aa_netProfitMargin_prof&&(t.aa_netProfitMargin_prof.textContent=_(e.aa_netProfitMargin_prof)),t.aa_profitStatus_prof&&(t.aa_profitStatus_prof.textContent=e.aa_profitStatus_prof),t.aa_ROAS_prof&&(t.aa_ROAS_prof.textContent=g(e.aa_ROAS_prof,2,!1,"x")),t.aa_breakevenROAS_prof&&(t.aa_breakevenROAS_prof.textContent=isFinite(e.aa_breakevenROAS_prof)?g(e.aa_breakevenROAS_prof,2,!1,"x"):"-"),t.aa_ACOS_prof&&(t.aa_ACOS_prof.textContent=_(e.aa_ACOS_prof)),t.aa_breakevenACOS_prof&&(t.aa_breakevenACOS_prof.textContent=_(e.aa_breakevenACOS_prof)),t.aa_adImpressions_eng&&(t.aa_adImpressions_eng.textContent=y(e.aa_adImpressions_eng)),t.aa_adClicks_eng&&(t.aa_adClicks_eng.textContent=y(e.aa_adClicks_eng)),t.aa_CTR_eng&&(t.aa_CTR_eng.textContent=_(e.aa_CTR_eng)),t.aa_totalAdSpend_eng&&(t.aa_totalAdSpend_eng.textContent=m(e.aa_totalAdSpend_eng,r)),t.aa_CPC_eng&&(t.aa_CPC_eng.textContent=m(e.aa_CPC_eng,r)),t.aa_CPM_eng&&(t.aa_CPM_eng.textContent=m(e.aa_CPM_eng,r)),t.aa_RPC_eng&&(t.aa_RPC_eng.textContent=m(e.aa_RPC_eng,r)),t.aa_PPC_eng&&(t.aa_PPC_eng.textContent=m(e.aa_PPC_eng,r,!0)),t.aa_adOrders_eng&&(t.aa_adOrders_eng.textContent=y(e.aa_adOrders_eng)),t.aa_CVR_eng&&(t.aa_CVR_eng.textContent=_(e.aa_CVR_eng)),t.aa_AOV_eng&&(t.aa_AOV_eng.textContent=m(e.aa_AOV_eng,r)),t.aa_CPA_eng&&(t.aa_CPA_eng.textContent=m(e.aa_CPA_eng,r)),t.aa_profitPerSale_eng&&(t.aa_profitPerSale_eng.textContent=m(e.aa_profitPerSale_eng,r,!0)),t.co_blendedROAS&&(t.co_blendedROAS.textContent=g(e.co_blendedROAS,2,!1,"x")),t.co_overallShopNetProfitLoss&&(t.co_overallShopNetProfitLoss.textContent=m(e.co_overallShopNetProfitLoss,r,!0)),t.co_TACoS_percent&&(t.co_TACoS_percent.textContent=_(e.co_TACoS_percent)),t.co_percentRevenueFromAds&&(t.co_percentRevenueFromAds.textContent=_(e.co_percentRevenueFromAds)),t.co_percentOrdersFromAds&&(t.co_percentOrdersFromAds.textContent=_(e.co_percentOrdersFromAds)),t.co_combinedConversionRate&&(t.co_combinedConversionRate.textContent=`Organic: ${_(e.co_organicCVR_forOverview)} | Ads: ${_(e.co_adCVR_forOverview)}`),t.co_combinedAOV&&(t.co_combinedAOV.textContent=`Organic: ${m(e.co_organicAOV_forOverview,r)} | Ads: ${m(e.co_adAOV_forOverview,r)}`),t.co_adSpendToOverallGrossProfitRatio_percent&&(t.co_adSpendToOverallGrossProfitRatio_percent.textContent=_(e.co_adSpendToOverallGrossProfitRatio_percent)),H(a,e,o.currentView,o.currentCategoryFilter,o.dismissedRecommendationIds,o.recommendationEventCallbacks).catch(s=>console.error("Error rendering recommendations from updateDOM:",s)),["cdt_ad_visits","cdt_organic_visits","cdt_total_visits","cdt_ad_orders","cdt_organic_orders","cdt_total_orders","cdt_ad_cvr","cdt_organic_cvr","cdt_total_cvr","cdt_ad_revenue","cdt_organic_revenue","cdt_total_revenue","cdt_ad_aov","cdt_organic_aov","cdt_total_aov","cdt_ad_revenuePercent","cdt_organic_revenuePercent","cdt_ad_ordersPercent","cdt_organic_ordersPercent"].forEach(s=>{if(t[s]&&e[s]!==void 0){let l=e[s];s.endsWith("_cvr")||s.endsWith("Percent")?t[s].textContent=_(l):s.endsWith("_revenue")||s.endsWith("_aov")?t[s].textContent=m(l,r):t[s].textContent=y(l)}}),t.budgetUtilizationText&&(a.dailyAdBudget>0&&a.performancePeriod_days>0?t.budgetUtilizationText.textContent=`You've utilized ${g(e.m_budget_utilization_percent,1)}% of your ad budget for this period, spending ${m(a.totalAdSpend,r)} out of a planned ${m(e.m_budget_totalBudgetedForPeriod,r)}.`:t.budgetUtilizationText.textContent="Enter your Daily Budget and Performance Period to see budget utilization."),t.budgetUtilizationProgressBarFill){const s=Math.min(100,Math.max(0,e.m_budget_utilization_percent));t.budgetUtilizationProgressBarFill.style.width=`${s}%`,t.budgetUtilizationProgressBarFill.classList.toggle("over-budget",e.m_budget_utilization_percent>100)}t.budgetUtilizationPercentageOnBar&&(t.budgetUtilizationPercentageOnBar.textContent=`${g(e.m_budget_utilization_percent,1)}%`)}function Ee(){const e="-",a=t.currencySymbol?.value||"USD";[t.roasStatValue,t.breakevenRoasStatValue,t.netAdProfitStatValue,t.aa_performancePeriod,t.aa_totalAdSpend_sum,t.aa_totalAdRevenue_sum,t.aa_adOrders_sum,t.aa_netAdProfit_sum,t.aa_ROAS_kpr,t.aa_ACOS_kpr,t.aa_CVR_kpr,t.aa_CPA_kpr,t.aa_totalAdRevenue_prof,t.aa_totalAdSpend_prof,t.aa_COGS_prof,t.aa_totalCosts_prof,t.aa_netProfit_prof,t.aa_netProfitMargin_prof,t.aa_profitStatus_prof,t.aa_ROAS_prof,t.aa_breakevenROAS_prof,t.aa_ACOS_prof,t.aa_breakevenACOS_prof,t.aa_adImpressions_eng,t.aa_adClicks_eng,t.aa_CTR_eng,t.aa_totalAdSpend_eng,t.aa_CPC_eng,t.aa_CPM_eng,t.aa_RPC_eng,t.aa_PPC_eng,t.aa_adOrders_eng,t.aa_CVR_eng,t.aa_AOV_eng,t.aa_CPA_eng,t.aa_profitPerSale_eng,t.co_blendedROAS,t.co_overallShopNetProfitLoss,t.co_TACoS_percent,t.co_percentRevenueFromAds,t.co_percentOrdersFromAds,t.cdt_ad_visits,t.cdt_organic_visits,t.cdt_total_visits,t.cdt_ad_orders,t.cdt_organic_orders,t.cdt_total_orders,t.cdt_ad_cvr,t.cdt_organic_cvr,t.cdt_total_cvr,t.cdt_ad_revenue,t.cdt_organic_revenue,t.cdt_total_revenue,t.cdt_ad_aov,t.cdt_organic_aov,t.cdt_total_aov,t.cdt_ad_revenuePercent,t.cdt_organic_revenuePercent,t.cdt_ad_ordersPercent,t.cdt_organic_ordersPercent].forEach(r=>{r&&(r.textContent=e)}),t.profitabilityStatusBadge&&(t.profitabilityStatusBadge.textContent="",t.profitabilityStatusBadge.className="inline-flex items-center whitespace-nowrap mix-blend-multiply rounded-full min-h-[22px] px-[7px] py-px text-xs leading-18px gap-x-1.5 border border-p-gray-200 bg-p-gray-50 text-p-gray-700",t.profitabilityStatusBadge.classList.add("hidden")),t.profitabilityMessageTitle&&(t.profitabilityMessageTitle.textContent="Performance Analysis"),t.profitabilityMessageText&&(t.profitabilityMessageText.innerHTML="Enter your ad data to see detailed insights."),t.profitabilityMessageCard&&(t.profitabilityMessageCard.className="p-4 rounded-lg mt-4 shadow-custom-xs bg-p-gray-25 border border-p-gray-200 text-p-gray-700"),t.co_combinedConversionRate&&(t.co_combinedConversionRate.textContent="Organic: - | Ads: -"),t.co_combinedAOV&&(t.co_combinedAOV.textContent=`Organic: ${m(NaN,a)} | Ads: ${m(NaN,a)}`),t.budgetUtilizationText&&(t.budgetUtilizationText.textContent="Enter your Daily Budget and Performance Period to see budget utilization."),t.budgetUtilizationProgressBarFill&&(t.budgetUtilizationProgressBarFill.style.width="0%",t.budgetUtilizationProgressBarFill.classList.remove("over-budget")),t.budgetUtilizationPercentageOnBar&&(t.budgetUtilizationPercentageOnBar.textContent="0%"),t.recommendationsEmptyState&&(t.recommendationsEmptyState.style.display="flex"),t.recommendationOutputArea&&(t.recommendationOutputArea.innerHTML="",t.recommendationOutputArea.style.display="none"),t.categoryFilters&&(t.categoryFilters.innerHTML="")}const G={onFilterClick:e=>Fe(e),onActionClick:(e,a,o)=>Me(e,a,o),onDismissClick:e=>Ve(e)};function O(){console.log("Logger: handleLiveCalculatePerformance() triggered.");const e=fe(),a=ve(e);console.log("Logger: Inputs and metrics calculated.",{inputs:e,metrics:a});const o=U(),r=le(),n=ue();if(!(t.totalAdSpend&&t.totalAdSpend.value.trim()!==""&&t.totalAdRevenue_fromAds&&t.totalAdRevenue_fromAds.value.trim()!==""&&t.averageProductProfitMargin_percent&&t.averageProductProfitMargin_percent.value.trim()!=="")){t.profitabilityMessageCard&&(t.profitabilityMessageCard.style.display="none"),Ee(),H(e,null,o,r,n,G).catch(s=>console.error("Error rendering recommendations on core input check:",s));return}t.profitabilityMessageCard&&(t.profitabilityMessageCard.style.display="block"),console.log("Logger: Updating DOM..."),Be(a,e,{currentView:o,currentCategoryFilter:r,dismissedRecommendationIds:n,recommendationEventCallbacks:G}),console.log("Logger: DOM update complete.")}const K=me(O,350);function w(e){ge(e);const a=e==="advanced";t.normalInputsContainer&&(t.normalInputsContainer.style.display=a?"none":"grid"),t.advancedInputsContainer&&(t.advancedInputsContainer.style.display=a?"block":"none"),t.advertisingAnalysisSectionWrapper&&(t.advertisingAnalysisSectionWrapper.style.display=a?"block":"none"),t.organicVsAdComparisonSectionWrapper&&(t.organicVsAdComparisonSectionWrapper.style.display=a?"block":"none"),t.budgetUtilizationSectionWrapper&&(t.budgetUtilizationSectionWrapper.style.display=a?"block":"none"),t.exportSection&&(t.exportSection.style.display=a?"flex":"none"),t.toggleNormalViewButton&&t.toggleNormalViewButton.classList.toggle("active",!a),t.toggleAdvancedViewButton&&t.toggleAdvancedViewButton.classList.toggle("active",a),a&&_e(),O()}function k(e,a,o){const r=e.dataset.tabTarget;o.forEach(n=>{n&&(n.classList.remove("active"),n.classList.add("hidden"),n.id===r&&(n.classList.add("active"),n.classList.remove("hidden")))}),a.forEach(n=>{n&&n.classList.remove("active")}),e&&e.classList.add("active")}function Fe(e){de(e),O()}function Ve(e){ce(e),O()}function Me(e,a,o){a==="link"?window.open(o,"_blank"):a==="function_call"?o==="toggleAdvancedView"?w("advanced"):console.warn(`Unhandled function_call target: ${o} for recommendation: ${e}`):console.warn(`Unknown action type: ${a} for recommendation: ${e}`)}const $e={totalAdSpendInput:{title:"Total Ad Spend",text:"Enter the total amount spent on your Etsy advertising campaigns for the selected period.",maxWidth:"w-72 sm:w-80"},totalAdRevenueInput:{title:"Total Ad Revenue",text:"Enter the total revenue generated directly from your Etsy ads for the selected period.",maxWidth:"w-72 sm:w-80"},avgProfitMarginInput:{title:"Average Product Profit Margin (%)",text:"Enter your average profit margin per product after COGS and Etsy transaction/listing fees, but before ad spend. E.g., if a product sells for $20, and costs $10 (COGS+fees), your profit margin is 50%.",maxWidth:"w-72 sm:w-80"},advViewsInput:{title:"Ad Views (Impressions)",text:"Enter the total number of times your ads were shown (impressions) during the performance period.",maxWidth:"max-w-xs"},advClicksInput:{title:"Ad Clicks",text:"Enter the total number of clicks your ads received during the performance period.",maxWidth:"max-w-xs"},advOrdersInput:{title:"Ad Orders",text:"Enter the total number of orders generated directly from your ads during the performance period.",maxWidth:"max-w-xs"},advDailyBudgetInput:{title:"Daily Ad Budget",text:"Enter your average daily budget for Etsy Ads. This helps in budget utilization calculations if a performance period is also set.",maxWidth:"max-w-xs"},advPerfPeriodInput:{title:"Performance Period",text:"Select the time range for which your ad performance data applies. Ensure this matches your Shop Stats data period for accurate comparisons.",maxWidth:"max-w-xs"},advCurrencyInput:{title:"Currency",text:"Select the currency used for your ad spend and revenue figures.",maxWidth:"max-w-xs"},etsyAdsExternalLink:{title:"Go to Etsy Ads",text:"Opens your Etsy Ads dashboard. With the Alura extension installed, your data is automatically copied. Return here and click the import icon to paste.",maxWidth:"max-w-xs"},etsyAdsImport:{title:"Import Ads Data",text:"After visiting your Etsy Ads page with our extension installed, click here to paste your automatically copied data.",maxWidth:"max-w-xs"},shopStatsExternalLink:{title:"Go to Etsy Stats",text:"Opens your Shop Stats dashboard. With the Alura extension installed, your data is automatically copied. Return here and click the import icon to paste.",maxWidth:"max-w-xs"},shopStatsImport:{title:"Import Stats Data",text:"After visiting your Etsy Stats page with our extension installed, click here to paste your automatically copied data.",maxWidth:"max-w-xs"},shopVisitsInput:{title:"Total Overall Shop Visits",text:"Enter the total number of visits your entire Etsy shop received during the same performance period as your ad data.",maxWidth:"max-w-xs"},shopOrdersInput:{title:"Total Overall Shop Orders",text:"Enter the total number of orders your entire Etsy shop received during the same performance period.",maxWidth:"max-w-xs"},shopRevenueInput:{title:"Total Overall Shop Revenue",text:"Enter the total revenue your entire Etsy shop generated during the same performance period.",maxWidth:"max-w-xs"},roasStat:{title:"ROAS (Return on Ad Spend)",text:"Your return from ad spend. For every $1 spent on ads, this is how much revenue your ads generated.",formulaTitle:"Formula",formulaCode:"Total Ad Revenue / Total Ad Spend",maxWidth:"sm:w-80 w-72"},breakevenRoasStat:{title:"Breakeven ROAS",text:"The ROAS needed to cover your product costs and ad spend. A ROAS above this value means you are profitable.",formulaTitle:"Formula",formulaCode:"1 / Average Product Profit Margin",maxWidth:"sm:w-80 w-72"},netAdProfitStat:{title:"Net Ad Profit",text:"The actual profit earned from your ads after deducting ad spend and the cost of goods sold (based on your profit margin).",formulaTitle:"Formula",formulaCode:"(Ad Revenue * Avg. Profit Margin) - Ad Spend",maxWidth:"sm:w-80 w-72"},aa_performancePeriod:{title:"Performance Period",text:"The selected date range for which this advertising data is analyzed.",maxWidth:"sm:w-80 w-72"},aa_totalAdSpend_sum:{title:"Total Ad Spend",text:"The total amount of money spent on advertising during the performance period.",maxWidth:"sm:w-80 w-72"},aa_totalAdRevenue_sum:{title:"Total Ad Revenue",text:"The total revenue generated directly from these advertisements.",maxWidth:"sm:w-80 w-72"},aa_adOrders_sum:{title:"Orders from Ads",text:"The total number of orders that resulted directly from clicks on your ads.",maxWidth:"sm:w-80 w-72"},aa_netAdProfit_sum:{title:"Net Ad Profit",text:"The profit specifically from advertising after deducting ad spend and product costs attributed to ad revenue.",formulaTitle:"Formula",formulaCode:"(Ad Revenue * Profit Margin) - Ad Spend",maxWidth:"sm:w-80 w-72"},aa_ROAS_kpi:{title:"Return on Ad Spend (ROAS)",text:"Measures the gross revenue generated for every dollar spent on advertising.",formulaTitle:"Formula",formulaCode:"Total Ad Revenue / Total Ad Spend",maxWidth:"sm:w-80 w-72"},aa_ACOS_kpi:{title:"Advertising Cost of Sales (ACOS)",text:"The percentage of ad revenue that was spent on advertising.",formulaTitle:"Formula",formulaCode:"(Total Ad Spend / Total Ad Revenue) * 100%",maxWidth:"sm:w-80 w-72"},aa_CVR_kpi:{title:"Ad Conversion Rate (CVR)",text:"The percentage of ad clicks that resulted in an order.",formulaTitle:"Formula",formulaCode:"(Ad Orders / Ad Clicks) * 100%",maxWidth:"sm:w-80 w-72"},aa_CPA_kpi:{title:"Cost Per Acquisition (CPA)",text:"The average cost to acquire one customer (order) through your ads.",formulaTitle:"Formula",formulaCode:"Total Ad Spend / Ad Orders",maxWidth:"sm:w-80 w-72"},aa_totalAdRevenue_prof:{title:"Total Ad Revenue",text:"Revenue generated directly from ads.",maxWidth:"sm:w-80 w-72"},aa_totalAdSpend_prof:{title:"Total Ad Spend",text:"Total cost of advertising.",maxWidth:"sm:w-80 w-72"},aa_COGS_prof:{title:"Product & Etsy Fees (from Ad Revenue)",text:"Estimated cost of goods sold and Etsy fees for items sold via ads, calculated from Ad Revenue and your Average Product Profit Margin. Does not include ad spend itself.",formulaTitle:"Formula",formulaCode:"Ad Revenue * (1 - Avg. Profit Margin)",maxWidth:"sm:w-80 w-72"},aa_totalCosts_prof:{title:"Total Costs (Ads)",text:"Sum of ad spend and the cost of goods/fees for items sold via ads.",formulaTitle:"Formula",formulaCode:"Ad Spend + Product & Etsy Fees (Ad Revenue)",maxWidth:"sm:w-80 w-72"},aa_netProfit_prof:{title:"Net Profit (from Ads)",text:"The final profit from advertising activities.",formulaTitle:"Formula",formulaCode:"Total Ad Revenue - Total Costs (Ads)",maxWidth:"sm:w-80 w-72"},aa_netProfitMargin_prof:{title:"Net Profit Margin (from Ads) (%)",text:"The percentage of ad revenue that is net profit.",formulaTitle:"Formula",formulaCode:"(Net Profit (Ads) / Ad Revenue) * 100%",maxWidth:"sm:w-80 w-72"},aa_profitStatus_prof:{title:"Profit Status",text:"Indicates whether your advertising is profitable, at break-even, or not profitable based on ROAS vs. Breakeven ROAS.",maxWidth:"sm:w-80 w-72"},aa_ROAS_prof:{title:"ROAS (Return on Ad Spend)",text:"Same as the KPI ROAS. Repeated here for context in profitability analysis.",formulaTitle:"Formula",formulaCode:"Total Ad Revenue / Total Ad Spend",maxWidth:"sm:w-80 w-72"},aa_breakevenROAS_prof:{title:"Breakeven ROAS",text:"The ROAS required to cover product costs and ad spend. If your ROAS is higher, you are profitable.",formulaTitle:"Formula",formulaCode:"1 / Average Product Profit Margin",maxWidth:"sm:w-80 w-72"},aa_ACOS_prof:{title:"ACOS (Advertising Cost of Sales) (%)",text:"Percentage of ad revenue spent on advertising. Lower is generally better.",formulaTitle:"Formula",formulaCode:"(Total Ad Spend / Total Ad Revenue) * 100%",maxWidth:"sm:w-80 w-72"},aa_breakevenACOS_prof:{title:"Breakeven ACOS (%)",text:"The ACOS at which you neither make nor lose money from ads. This is your Average Product Profit Margin.",formulaTitle:"Formula",formulaCode:"Average Product Profit Margin * 100%",maxWidth:"sm:w-80 w-72"},aa_adImpressions_eng:{title:"Ad Impressions (Views)",text:"Total times your ads were displayed.",maxWidth:"sm:w-80 w-72"},aa_adClicks_eng:{title:"Ad Clicks",text:"Total clicks your ads received.",maxWidth:"sm:w-80 w-72"},aa_CTR_eng:{title:"Click-Through Rate (CTR) (%)",text:"Percentage of impressions that resulted in a click.",formulaTitle:"Formula",formulaCode:"(Ad Clicks / Ad Impressions) * 100%",maxWidth:"sm:w-80 w-72"},aa_totalAdSpend_eng:{title:"Total Ad Spend",text:"Total cost of advertising.",maxWidth:"sm:w-80 w-72"},aa_CPC_eng:{title:"Cost Per Click (CPC)",text:"Average cost for each click on your ad.",formulaTitle:"Formula",formulaCode:"Total Ad Spend / Ad Clicks",maxWidth:"sm:w-80 w-72"},aa_CPM_eng:{title:"Cost Per Mille (CPM)",text:"Cost for one thousand ad impressions.",formulaTitle:"Formula",formulaCode:"(Total Ad Spend / Ad Impressions) * 1000",maxWidth:"sm:w-80 w-72"},aa_RPC_eng:{title:"Revenue Per Click (RPC)",text:"Average revenue generated per ad click.",formulaTitle:"Formula",formulaCode:"Total Ad Revenue / Ad Clicks",maxWidth:"sm:w-80 w-72"},aa_PPC_eng:{title:"Profit Per Click (PPC)",text:"Average net profit generated per ad click, after accounting for product costs and ad spend per click.",formulaTitle:"Formula",formulaCode:"(Ad Revenue per Click * Avg Profit Margin) - CPC",maxWidth:"sm:w-80 w-72"},aa_adOrders_eng:{title:"Orders from Ads",text:"Total orders generated from ads.",maxWidth:"sm:w-80 w-72"},aa_CVR_eng:{title:"Ad Conversion Rate (CVR) (%)",text:"Percentage of ad clicks that resulted in a sale.",formulaTitle:"Formula",formulaCode:"(Ad Orders / Ad Clicks) * 100%",maxWidth:"sm:w-80 w-72"},aa_AOV_eng:{title:"Average Order Value (AOV) from Ads",text:"Average revenue amount per ad order.",formulaTitle:"Formula",formulaCode:"Total Ad Revenue / Ad Orders",maxWidth:"sm:w-80 w-72"},aa_CPA_eng:{title:"Cost Per Acquisition (CPA)",text:"Average cost to acquire one order via ads.",formulaTitle:"Formula",formulaCode:"Total Ad Spend / Ad Orders",maxWidth:"sm:w-80 w-72"},aa_profitPerSale_eng:{title:"Profit Earned per Ad Sale",text:"Average net profit from each sale attributed to ads.",formulaTitle:"Formula",formulaCode:"(AOV from Ads * Avg. Profit Margin) - CPA",maxWidth:"sm:w-80 w-72"},co_blendedROAS_stat:{title:"Blended ROAS",text:"Overall return considering both ad revenue and total shop revenue against ad spend. This shows how ads contribute to overall shop efficiency.",formulaTitle:"Formula",formulaCode:"Total Shop Revenue / Total Ad Spend",maxWidth:"sm:w-80 w-72"},co_overallNetProfit_stat:{title:"Overall Shop Net Profit",text:"The total net profit of your shop, after accounting for all product costs, Etsy fees, and ad spend.",formulaTitle:"Formula",formulaCode:"(Total Shop Revenue * Avg. Profit Margin) - Total Ad Spend",maxWidth:"sm:w-80 w-72"},co_TACoS_stat:{title:"TACoS (Total Advertising Cost of Sales) (%)",text:"The percentage of your total shop revenue that was spent on advertising. This shows the ad spend impact on overall sales.",formulaTitle:"Formula",formulaCode:"(Total Ad Spend / Total Shop Revenue) * 100%",maxWidth:"sm:w-80 w-72"},co_percentRevenueFromAds:{title:"Revenue from Ads (%)",text:"The percentage of your total shop revenue that came directly from ads.",formulaTitle:"Formula",formulaCode:"(Total Ad Revenue / Total Shop Revenue) * 100%",maxWidth:"sm:w-80 w-72"},co_percentOrdersFromAds:{title:"Orders from Ads (%)",text:"The percentage of your total shop orders that came directly from ads.",formulaTitle:"Formula",formulaCode:"(Ad Orders / Total Shop Orders) * 100%",maxWidth:"sm:w-80 w-72"},co_combinedConversionRate:{title:"Conversion Rate (Organic vs. Ads)",text:"Comparison of conversion rates between your organic traffic and ad traffic. Organic CVR: (Organic Orders / Organic Visits) * 100%. Ad CVR: (Ad Orders / Ad Clicks) * 100%.",maxWidth:"sm:w-80 w-72"},co_combinedAOV:{title:"Average Order Value (Organic vs. Ads)",text:"Comparison of AOV between organic sales and ad-driven sales. Organic AOV: Organic Revenue / Organic Orders. Ad AOV: Ad Revenue / Ad Orders.",maxWidth:"sm:w-80 w-72"},co_adSpendToOverallGrossProfitRatio_percent:{title:"Ad Spend to Overall Gross Profit Ratio (%)",text:"The percentage of your total shop's gross profit (before ad spend) that is consumed by ad spend. Helps understand ad cost relative to overall profitability.",formulaTitle:"Formula",formulaCode:"(Ad Spend / (Shop Revenue * Avg. Profit Margin)) * 100%",maxWidth:"sm:w-80 w-72"}};function De(){document.querySelectorAll("[data-tooltip-id]").forEach(a=>{const o=a.dataset.tooltipId,r=$e[o];if(!r){console.warn(`Tooltip definition not found for ID: ${o}`);return}const n=r.maxWidth||"min-w-[260px] w-72 sm:w-80",d=document.createElement("div");d.className=`absolute bottom-full left-1/2 transform -translate-x-1/2 z-20 mb-2 ${n} bg-p-gray-950 text-p-base-white p-3 rounded-lg shadow-lg text-left invisible opacity-0 scale-95 translate-y-1 group-hover:visible group-hover:opacity-100 group-hover:scale-100 group-hover:translate-y-0 transition-all duration-300 ease-in-out pointer-events-none group-hover:pointer-events-auto min-w-[260px]`;let s="";if(r.title&&(s+=`<span class="block font-semibold text-p-base-white mb-1 text-xs">${r.title}</span>`),r.text){const i=r.formulaTitle?"mb-2":"";s+=`<span class="block text-p-base-white/80 text-xs leading-relaxed ${i}">${r.text}</span>`}r.formulaTitle&&r.formulaCode&&(s+=`
                    <span class="block font-medium text-p-base-white/60 text-xs mt-2 mb-0.5">${r.formulaTitle}</span>
                    <code class="block font-mono bg-p-base-white/[.08] text-p-base-white p-1.5 rounded text-xs whitespace-pre-wrap break-all">${r.formulaCode}</code>`),d.innerHTML=s;const l=document.createElement("div");l.className="absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-x-[6px] border-x-transparent border-t-[6px] border-t-p-gray-950",d.appendChild(l),a.appendChild(d)})}function j(){const e=document.getElementById("performancePeriodDropdown")?.value||"last30",a=`https://www.etsy.com/your/shops/me/advertising?get_metrics=summary&period=${encodeURIComponent(e)}`,o=`https://www.etsy.com/your/shops/me/stats?get_metrics=summary&period=${encodeURIComponent(e)}`,r=document.getElementById("etsyAdsExternalLink"),n=document.getElementById("shopStatsExternalLink");r&&(r.href=a),n&&(n.href=o)}const Z={views:["adImpressions"],clicks:["adClicks"],orders:["adOrders"],daily_budget:["dailyAdBudget"],revenue:["adv_totalAdRevenue_fromAds","totalAdRevenue_fromAds"],spend:["adv_totalAdSpend","totalAdSpend"],total_overall_shop_visits:["totalShopVisits"],total_overall_shop_orders:["totalOverallShopOrders"],total_overall_shop_revenue:["totalOverallShopRevenue"]};function X(e){for(const a in e)Z[a]&&Z[a].forEach(o=>{const r=document.getElementById(o);r&&(r.value=e[a],r.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})))})}function Le(){const e=new URLSearchParams(window.location.search);if(e.toString()){const a=Object.fromEntries(e.entries());X(a)}}async function J(e){e.preventDefault();const a=e.currentTarget,o=a.innerHTML,r='<svg class="w-4 h-4 mix-blend-multiply text-green-600" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',n='<svg class="w-4 h-4 mix-blend-multiply text-red-600" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';try{const d=await navigator.clipboard.readText();if(!d)throw new Error("Clipboard is empty.");const s=JSON.parse(d);X(s),a.innerHTML=r,setTimeout(()=>{a.innerHTML=o},2e3)}catch(d){console.error("Failed to import from clipboard:",d.message),a.innerHTML=n,setTimeout(()=>{a.innerHTML=o},2e3)}}function Ne(){j();const e=document.getElementById("performancePeriodDropdown");e&&e.addEventListener("change",j),Le();const a=document.getElementById("etsyAdsImport"),o=document.getElementById("shopStatsImport");a&&a.addEventListener("click",J),o&&o.addEventListener("click",J)}const Q={totalAdSpend:"Total Ad Spend (Input)",totalAdRevenue_fromAds:"Total Ad Revenue from Ads (Input)",averageProductProfitMargin_percent:"Average Product Profit Margin % (Input)",adImpressions:"Ad Impressions/Views (Input)",adClicks:"Ad Clicks (Input)",adOrders:"Ad Orders (Input)",dailyAdBudget:"Daily Ad Budget (Input)",performancePeriod_days:"Performance Period (Days)",selectedPeriodString:"Selected Performance Period",currencyCode:"Currency Code",totalOverallShopRevenue:"Total Overall Shop Revenue (Input)",totalOverallShopOrders:"Total Overall Shop Orders (Input)",totalShopVisits:"Total Shop Visits (Input)",isAdvancedDataAvailable:"Is Advanced Data Available (Calculated Flag)",aa_performancePeriod:"Ad Analysis - Performance Period (Calculated Days)",aa_selectedPeriodString:"Ad Analysis - Selected Performance Period Name",aa_totalAdSpend_sum:"Ad Analysis - Total Ad Spend (Summary)",aa_totalAdRevenue_sum:"Ad Analysis - Total Ad Revenue (Summary)",aa_adOrders_sum:"Ad Analysis - Orders from Ads (Summary)",aa_netAdProfit_sum:"Ad Analysis - Net Ad Profit (Summary)",aa_ROAS_kpr:"Ad Analysis - ROAS (Key Performance Indicator)",aa_ACOS_kpr:"Ad Analysis - ACOS % (Key Performance Indicator)",aa_CVR_kpr:"Ad Analysis - Ad Conversion Rate % (Key Performance Indicator)",aa_CPA_kpr:"Ad Analysis - Cost Per Acquisition (Key Performance Indicator)",aa_totalAdRevenue_prof:"Ad Analysis - Total Ad Revenue (Profitability)",aa_totalAdSpend_prof:"Ad Analysis - Total Ad Spend (Profitability)",aa_COGS_prof:"Ad Analysis - Product & Etsy Fees (COGS for Ad Sales)",aa_totalCosts_prof:"Ad Analysis - Total Costs for Ads",aa_netProfit_prof:"Ad Analysis - Net Profit from Ads",aa_netProfitMargin_prof:"Ad Analysis - Net Profit Margin from Ads %",aa_profitStatus_prof:"Ad Analysis - Ad Profit Status",aa_ROAS_prof:"Ad Analysis - ROAS (Profitability)",aa_breakevenROAS_prof:"Ad Analysis - Breakeven ROAS",aa_ACOS_prof:"Ad Analysis - ACOS % (Profitability)",aa_breakevenACOS_prof:"Ad Analysis - Breakeven ACOS %",aa_adImpressions_eng:"Ad Analysis - Ad Impressions/Views (Engagement)",aa_adClicks_eng:"Ad Analysis - Ad Clicks (Engagement)",aa_CTR_eng:"Ad Analysis - Click-Through Rate (CTR) %",aa_totalAdSpend_eng:"Ad Analysis - Total Ad Spend (Engagement)",aa_CPC_eng:"Ad Analysis - Cost Per Click (CPC)",aa_CPM_eng:"Ad Analysis - Cost Per Mille (CPM)",aa_RPC_eng:"Ad Analysis - Revenue Per Click (RPC)",aa_PPC_eng:"Ad Analysis - Profit Per Click (PPC)",aa_adOrders_eng:"Ad Analysis - Orders from Ads (Engagement)",aa_CVR_eng:"Ad Analysis - Ad Conversion Rate % (Engagement)",aa_AOV_eng:"Ad Analysis - Average Order Value (AOV) from Ads",aa_CPA_eng:"Ad Analysis - Cost Per Acquisition (CPA - Engagement)",aa_profitPerSale_eng:"Ad Analysis - Profit Earned per Ad Sale",co_blendedROAS:"Comparison - Blended ROAS (Overall Shop Revenue / Total Ad Spend)",co_overallShopNetProfitLoss:"Comparison - Overall Shop Net Profit/Loss",co_TACoS_percent:"Comparison - Total Advertising Cost of Sales (TACoS) %",co_percentRevenueFromAds:"Comparison - Revenue from Ads % of Total Shop Revenue",co_percentOrdersFromAds:"Comparison - Orders from Ads % of Total Shop Orders",co_organicCVR_forOverview:"Comparison - Organic Conversion Rate % (Overview)",co_adCVR_forOverview:"Comparison - Ad Conversion Rate % (Overview)",co_organicAOV_forOverview:"Comparison - Organic Average Order Value (Overview)",co_adAOV_forOverview:"Comparison - Ad Average Order Value (Overview)",cdt_ad_visits:"Channel Deep Dive - Ad Channel Visits/Clicks",cdt_ad_orders:"Channel Deep Dive - Ad Channel Orders",cdt_ad_cvr:"Channel Deep Dive - Ad Channel Conversion Rate %",cdt_ad_revenue:"Channel Deep Dive - Ad Channel Revenue",cdt_ad_aov:"Channel Deep Dive - Ad Channel Average Order Value",cdt_ad_revenuePercent:"Channel Deep Dive - Ad Channel Revenue as % of Total",cdt_ad_ordersPercent:"Channel Deep Dive - Ad Channel Orders as % of Total",cdt_organic_visits:"Channel Deep Dive - Organic Channel Visits",cdt_organic_orders:"Channel Deep Dive - Organic Channel Orders",cdt_organic_cvr:"Channel Deep Dive - Organic Channel Conversion Rate %",cdt_organic_revenue:"Channel Deep Dive - Organic Channel Revenue",cdt_organic_aov:"Channel Deep Dive - Organic Channel Average Order Value",cdt_organic_revenuePercent:"Channel Deep Dive - Organic Channel Revenue as % of Total",cdt_organic_ordersPercent:"Channel Deep Dive - Organic Channel Orders as % of Total",cdt_total_visits:"Channel Deep Dive - Overall Shop Visits/Clicks",cdt_total_orders:"Channel Deep Dive - Overall Shop Orders",cdt_total_cvr:"Channel Deep Dive - Overall Shop Conversion Rate %",cdt_total_revenue:"Channel Deep Dive - Overall Shop Revenue",cdt_total_aov:"Channel Deep Dive - Overall Shop Average Order Value",m_budget_totalBudgetedForPeriod:"Budget - Total Budgeted For Period",m_budget_utilization_percent:"Budget - Budget Utilization %"};function ze(){const e=re(),a=ie();let o=`Metric,Value\r
`;for(const i in e)if(Object.hasOwnProperty.call(e,i)){const c=Q[i]||i.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());let u=e[i];i==="selectedPeriodString"||i==="currencyCode"?u=`"${String(u).replace(/"/g,'""')}"`:typeof u=="boolean"?u=u?"Yes":"No":typeof u=="number"?i.toLowerCase().includes("_percent")?u=_(u,!0):i.toLowerCase().includes("spend")||i.toLowerCase().includes("revenue")||i.toLowerCase().includes("budget")||i.toLowerCase().includes("aov")?u=m(u,e.currencyCode,!1,!0):u=g(u,2,!0):u=`"${String(u).replace(/"/g,'""')}"`,o+=`"${c.replace(/"/g,'""')}",${u}\r
`}for(const i in a)if(Object.hasOwnProperty.call(a,i)){const c=Q[i]||i.replace(/_/g," ").replace(/\b\w/g,f=>f.toUpperCase()),u=a[i];let p=u;typeof u=="number"?i.toLowerCase().includes("percent")||i.toLowerCase().includes("cvr")||i.toLowerCase().includes("acos")||i.toLowerCase().includes("ctr")||i==="m_budget_utilization_percent"?p=_(u,!0):i.toLowerCase().includes("spend")||i.toLowerCase().includes("revenue")||i.toLowerCase().includes("profit")||i.toLowerCase().includes("cpc")||i.toLowerCase().includes("cpm")||i.toLowerCase().includes("rpc")||i.toLowerCase().includes("ppc")||i.toLowerCase().includes("aov")||i.toLowerCase().includes("cpa")||i==="m_budget_totalBudgetedForPeriod"?p=m(u,e.currencyCode,!1,!0):i.toLowerCase().includes("roas")?p=g(u,2,!0):i==="aa_performancePeriod"?p=y(u,!0):p=g(u,2,!0):typeof u=="string"&&(p=`"${u.replace(/"/g,'""')}"`),o+=`"${c.replace(/"/g,'""')}",${p}\r
`}const r=encodeURI(o),n=document.createElement("a");n.setAttribute("href",r);const l=`etsy_ads_performance_export_${new Date().toISOString().replace(/[:.]/g,"-")}.csv`;n.setAttribute("download",l),document.body.appendChild(n),n.click(),document.body.removeChild(n)}function ee(){console.log("Logger: initializeApp() called."),console.log("Logger: DOM elements cached."),De(),we(),Ne(),console.log("Logger: UI components initialized."),console.log("Logger: Attaching event listeners..."),[t.totalAdSpend,t.totalAdRevenue_fromAds,t.averageProductProfitMargin_percent,t.adv_totalAdSpend,t.adv_totalAdRevenue_fromAds,t.adv_averageProductProfitMargin_percent,t.adImpressions,t.adClicks,t.adOrders,t.dailyAdBudget,t.performancePeriodDropdown,t.currencySymbol,t.totalOverallShopRevenue,t.totalOverallShopOrders,t.totalShopVisits].forEach(a=>{a&&(a.addEventListener("input",K),a.tagName==="SELECT"&&a.addEventListener("change",K))}),console.log("Logger: Event listeners attached."),t.toggleNormalViewButton&&t.toggleNormalViewButton.addEventListener("click",()=>w("normal")),t.toggleAdvancedViewButton&&t.toggleAdvancedViewButton.addEventListener("click",()=>w("advanced")),t.adAnalysisTabButtons&&t.adAnalysisTabButtons.forEach(a=>{a.addEventListener("click",()=>k(a,t.adAnalysisTabButtons,t.adAnalysisTabContents))}),t.comparisonMetricsTabButtons&&t.comparisonMetricsTabButtons.forEach(a=>{a.addEventListener("click",()=>k(a,t.comparisonMetricsTabButtons,t.comparisonMetricsTabContents))}),t.exportCsvButton&&t.exportCsvButton.addEventListener("click",ze),ye(),console.log("Logger: Input sync initialized."),console.log("Logger: Setting initial view to 'normal'."),w("normal"),t.adAnalysisTabButtons&&t.adAnalysisTabButtons.length>0&&k(t.adAnalysisTabButtons[0],t.adAnalysisTabButtons,t.adAnalysisTabContents),t.comparisonMetricsTabButtons&&t.comparisonMetricsTabButtons.length>0&&k(t.comparisonMetricsTabButtons[0],t.comparisonMetricsTabButtons,t.comparisonMetricsTabContents),console.log("Logger: initializeApp() finished.")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ee):ee()})();
