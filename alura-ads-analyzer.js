const t={totalAdSpend:document.getElementById("totalAdSpend"),totalAdRevenue_fromAds:document.getElementById("totalAdRevenue_fromAds"),averageProductProfitMargin_percent:document.getElementById("averageProductProfitMargin_percent"),adv_averageProductProfitMargin_percent:document.getElementById("adv_averageProductProfitMargin_percent"),adv_totalAdRevenue_fromAds:document.getElementById("adv_totalAdRevenue_fromAds"),adv_totalAdSpend:document.getElementById("adv_totalAdSpend"),adImpressions:document.getElementById("adImpressions"),adClicks:document.getElementById("adClicks"),adOrders:document.getElementById("adOrders"),dailyAdBudget:document.getElementById("dailyAdBudget"),performancePeriodDropdown:document.getElementById("performancePeriodDropdown"),currencySymbol:document.getElementById("currencySymbol"),totalOverallShopRevenue:document.getElementById("totalOverallShopRevenue"),totalOverallShopOrders:document.getElementById("totalOverallShopOrders"),totalShopVisits:document.getElementById("totalShopVisits"),roasStatValue:document.getElementById("roasStatValue"),breakevenRoasStatValue:document.getElementById("breakevenRoasStatValue"),netAdProfitStatValue:document.getElementById("netAdProfitStatValue"),profitabilityStatusBadge:document.getElementById("profitabilityStatusBadge"),profitabilityMessageCard:document.getElementById("profitabilityMessageCard"),profitabilityMessageTitle:document.getElementById("profitabilityMessageTitle"),profitabilityMessageText:document.getElementById("profitabilityMessageText"),toggleNormalViewButton:document.getElementById("toggleNormalViewButton"),toggleAdvancedViewButton:document.getElementById("toggleAdvancedViewButton"),normalInputsContainer:document.getElementById("normalInputsContainer"),advancedInputsContainer:document.getElementById("advancedInputsContainer"),advertisingAnalysisSectionWrapper:document.getElementById("advertisingAnalysisSectionWrapper"),organicVsAdComparisonSectionWrapper:document.getElementById("organicVsAdComparisonSectionWrapper"),budgetUtilizationSectionWrapper:document.getElementById("budgetUtilizationSectionWrapper"),budgetUtilizationText:document.getElementById("budgetUtilizationText"),budgetUtilizationProgressBarFill:document.getElementById("budgetUtilizationProgressFill"),budgetUtilizationPercentageOnBar:document.getElementById("budgetUtilizationPercentageOnBar"),recommendationsSection:document.getElementById("recommendationsSection"),recommendationsEmptyState:document.getElementById("recommendationsEmptyState"),recommendationOutputArea:document.getElementById("recommendationOutputArea"),categoryFilters:document.getElementById("categoryFilters"),recommendationsListContainer:document.getElementById("recommendationsListContainer"),adAnalysisTabButtons:document.querySelectorAll(".a--ad-analysis-tab-button"),adAnalysisTabContents:document.querySelectorAll(".a--ad-analysis-tab-content"),comparisonMetricsTabButtons:document.querySelectorAll(".a--comparison-tab-button"),comparisonMetricsTabContents:document.querySelectorAll(".a--comparison-tab-content"),exportCsvButton:document.getElementById("exportCsvButton"),aa_performancePeriod:document.getElementById("aa_performancePeriod"),aa_totalAdSpend_sum:document.getElementById("aa_totalAdSpend_sum"),aa_totalAdRevenue_sum:document.getElementById("aa_totalAdRevenue_sum"),aa_adOrders_sum:document.getElementById("aa_adOrders_sum"),aa_netAdProfit_sum:document.getElementById("aa_netAdProfit_sum"),aa_ROAS_kpr:document.getElementById("aa_ROAS_kpr"),aa_ACOS_kpr:document.getElementById("aa_ACOS_kpr"),aa_CVR_kpr:document.getElementById("aa_CVR_kpr"),aa_CPA_kpr:document.getElementById("aa_CPA_kpr"),aa_totalAdRevenue_prof:document.getElementById("aa_totalAdRevenue_prof"),aa_totalAdSpend_prof:document.getElementById("aa_totalAdSpend_prof"),aa_COGS_prof:document.getElementById("aa_COGS_prof"),aa_totalCosts_prof:document.getElementById("aa_totalCosts_prof"),aa_netProfit_prof:document.getElementById("aa_netProfit_prof"),aa_netProfitMargin_prof:document.getElementById("aa_netProfitMargin_prof"),aa_profitStatus_prof:document.getElementById("aa_profitStatus_prof"),aa_ROAS_prof:document.getElementById("aa_ROAS_prof"),aa_breakevenROAS_prof:document.getElementById("aa_breakevenROAS_prof"),aa_ACOS_prof:document.getElementById("aa_ACOS_prof"),aa_breakevenACOS_prof:document.getElementById("aa_breakevenACOS_prof"),aa_adImpressions_eng:document.getElementById("aa_adImpressions_eng"),aa_adClicks_eng:document.getElementById("aa_adClicks_eng"),aa_CTR_eng:document.getElementById("aa_CTR_eng"),aa_totalAdSpend_eng:document.getElementById("aa_totalAdSpend_eng"),aa_CPC_eng:document.getElementById("aa_CPC_eng"),aa_CPM_eng:document.getElementById("aa_CPM_eng"),aa_RPC_eng:document.getElementById("aa_RPC_eng"),aa_PPC_eng:document.getElementById("aa_PPC_eng"),aa_adOrders_eng:document.getElementById("aa_adOrders_eng"),aa_CVR_eng:document.getElementById("aa_CVR_eng"),aa_AOV_eng:document.getElementById("aa_AOV_eng"),aa_CPA_eng:document.getElementById("aa_CPA_eng"),aa_profitPerSale_eng:document.getElementById("aa_profitPerSale_eng"),co_blendedROAS:document.getElementById("co_blendedROAS"),co_overallShopNetProfitLoss:document.getElementById("co_overallShopNetProfitLoss"),co_TACoS_percent:document.getElementById("co_TACoS_percent"),co_percentRevenueFromAds:document.getElementById("co_percentRevenueFromAds"),co_percentOrdersFromAds:document.getElementById("co_percentOrdersFromAds"),co_combinedConversionRate:document.getElementById("co_combinedConversionRate"),co_combinedAOV:document.getElementById("co_combinedAOV"),cdt_ad_visits:document.getElementById("cdt_ad_visits"),cdt_organic_visits:document.getElementById("cdt_organic_visits"),cdt_total_visits:document.getElementById("cdt_total_visits"),cdt_ad_orders:document.getElementById("cdt_ad_orders"),cdt_organic_orders:document.getElementById("cdt_organic_orders"),cdt_total_orders:document.getElementById("cdt_total_orders"),cdt_ad_cvr:document.getElementById("cdt_ad_cvr"),cdt_organic_cvr:document.getElementById("cdt_organic_cvr"),cdt_total_cvr:document.getElementById("cdt_total_cvr"),cdt_ad_revenue:document.getElementById("cdt_ad_revenue"),cdt_organic_revenue:document.getElementById("cdt_organic_revenue"),cdt_total_revenue:document.getElementById("cdt_total_revenue"),cdt_ad_aov:document.getElementById("cdt_ad_aov"),cdt_organic_aov:document.getElementById("cdt_organic_aov"),cdt_total_aov:document.getElementById("cdt_total_aov"),cdt_ad_revenuePercent:document.getElementById("cdt_ad_revenuePercent"),cdt_organic_revenuePercent:document.getElementById("cdt_organic_revenuePercent"),cdt_ad_ordersPercent:document.getElementById("cdt_ad_ordersPercent"),cdt_organic_ordersPercent:document.getElementById("cdt_organic_ordersPercent")};let z={},U={},Y="normal",q="View all",W=new Set;function ee(e){z=e}function te(){return z}function ae(e){U=e}function re(){return U}function oe(e){Y=e}function G(){return Y}function ne(e){q=e}function ie(){return q}function se(e){W.add(e)}function de(){return W}const A=e=>({USD:"$",EUR:"€",GBP:"£",AUD:"A$",CAD:"C$",DKK:"kr.",HKD:"HK$",INR:"₹",IDR:"Rp",ILS:"₪",JPY:"¥",MYR:"RM",MXN:"MX$",MAD:"د.م.",NZD:"NZ$",NOK:"kr",PHP:"₱",SGD:"S$",ZAR:"R",SEK:"kr",CHF:"CHF",THB:"฿",TRY:"₺",UAH:"₴",VND:"₫"})[e]||e,g=(e,a="USD",r=!1,o=!1)=>{if(isNaN(e)||e===null||!isFinite(e))return o?"":"-";const i=Number(e);if(o)return i.toFixed(2);try{let s=new Intl.NumberFormat(void 0,{style:"currency",currency:a,minimumFractionDigits:2,maximumFractionDigits:2}).format(i);return r&&i>0?`+${s}`:s}catch(d){console.warn("Currency formatting error for code:",a,"- using basic formatting. Error:",d);const s=i.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});let l=A(a);const n=["Rp","د.م.","₫","₴","MAD"],c=["DKK","NOK","SEK","CHF","MYR","ZAR","IDR"];let u;return n.includes(a)||typeof l=="string"&&n.includes(l)?u=`${s} ${l}`:c.includes(a)||typeof l=="string"&&c.includes(l)?u=`${l} ${s}`:u=`${l}${s}`,r&&i>0?`+${u}`:u}},_=(e,a=!1)=>isNaN(e)||e===null||!isFinite(e)?a?"":"-":a?Number(e).toFixed(2):`${Number(e).toFixed(2)}%`,m=(e,a=2,r=!1,o="")=>{if(isNaN(e)||e===null||!isFinite(e))return r?"":"-";let i=Number(e).toFixed(a);return r?i:`${i}${o}`},v=(e,a=!1)=>isNaN(e)||e===null||!isFinite(e)?a?"":"-":a?Number(e).toFixed(0):Number(e).toLocaleString("en-US");function le(e,a){let r;return function(...o){clearTimeout(r),r=setTimeout(()=>{e.apply(this,o)},a)}}function ce(e){const a=new Date,r=a.getFullYear(),o=a.getMonth(),i=a.getDate();switch(e){case"today":return 1;case"yesterday":return 1;case"this_month":return i;case"last_month":return new Date(r,o,0).getDate();case"last_30_days":return 30;case"this_year":const d=new Date(r,0,1),s=a.getTime()-d.getTime();return Math.floor(s/(1e3*60*60*24))+1;case"all_time":return 731;default:return console.warn(`Unknown period: ${e}, defaulting to 30 days.`),30}}function ue(e){oe(e)}function ge(){const e=t.performancePeriodDropdown.value,a=G();let r=parseFloat(t.totalAdSpend.value)||0,o=parseFloat(t.totalAdRevenue_fromAds.value)||0,i=parseFloat(t.averageProductProfitMargin_percent.value)||0;a==="advanced"&&(t.adv_totalAdSpend&&t.adv_totalAdSpend.value.trim()!==""&&(r=parseFloat(t.adv_totalAdSpend.value)||0),t.adv_totalAdRevenue_fromAds&&t.adv_totalAdRevenue_fromAds.value.trim()!==""&&(o=parseFloat(t.adv_totalAdRevenue_fromAds.value)||0),t.adv_averageProductProfitMargin_percent&&t.adv_averageProductProfitMargin_percent.value.trim()!==""&&(i=parseFloat(t.adv_averageProductProfitMargin_percent.value)||0));const d={totalAdSpend:r,totalAdRevenue_fromAds:o,averageProductProfitMargin_percent:i,adImpressions:parseInt(t.adImpressions.value)||0,adClicks:parseInt(t.adClicks.value)||0,adOrders:parseInt(t.adOrders.value)||0,dailyAdBudget:parseFloat(t.dailyAdBudget.value)||0,performancePeriod_days:ce(e),selectedPeriodString:e,currencyCode:t.currencySymbol.value||"USD",totalOverallShopRevenue:parseFloat(t.totalOverallShopRevenue.value)||0,totalOverallShopOrders:parseInt(t.totalOverallShopOrders.value)||0,totalShopVisits:parseInt(t.totalShopVisits.value)||0,isAdvancedDataAvailable:a==="advanced"&&((parseInt(t.adImpressions.value)||0)>0||(parseInt(t.adClicks.value)||0)>0||(parseInt(t.adOrders.value)||0)>0)};return ee(d),d}function pe(){t.adv_totalAdSpend&&t.totalAdSpend&&(t.adv_totalAdSpend.value=t.totalAdSpend.value),t.adv_totalAdRevenue_fromAds&&t.totalAdRevenue_fromAds&&(t.adv_totalAdRevenue_fromAds.value=t.totalAdRevenue_fromAds.value),t.adv_averageProductProfitMargin_percent&&t.averageProductProfitMargin_percent&&(t.adv_averageProductProfitMargin_percent.value=t.averageProductProfitMargin_percent.value)}function me(){[{normalId:"totalAdSpend",advancedId:"adv_totalAdSpend"},{normalId:"totalAdRevenue_fromAds",advancedId:"adv_totalAdRevenue_fromAds"},{normalId:"averageProductProfitMargin_percent",advancedId:"adv_averageProductProfitMargin_percent"}].forEach(a=>{const r=t[a.normalId],o=t[a.advancedId];r&&o?(r.addEventListener("input",function(){o.value!==this.value&&(o.value=this.value)}),o.addEventListener("input",function(){r.value!==this.value&&(r.value=this.value)})):(r||console.error(`Error: Input field with ID '${a.normalId}' not found in DOMElements for synchronization.`),o||console.error(`Error: Input field with ID '${a.advancedId}' not found in DOMElements for synchronization.`))})}function fe(e){const a={},r=e.averageProductProfitMargin_percent/100,o=e.adOrders>0?e.totalAdRevenue_fromAds/e.adOrders:0,i=e.totalAdSpend>0?e.totalAdRevenue_fromAds/e.totalAdSpend:0,d=e.totalAdRevenue_fromAds>0?e.totalAdSpend/e.totalAdRevenue_fromAds*100:0,s=e.adOrders>0?e.totalAdSpend/e.adOrders:0,l=e.adClicks>0?e.adOrders/e.adClicks*100:0,c=e.totalAdRevenue_fromAds*r-e.totalAdSpend,u=e.totalAdRevenue_fromAds*(1-r),p=u+e.totalAdSpend,f=e.totalAdRevenue_fromAds>0?c/e.totalAdRevenue_fromAds*100:0;let y="Breakeven";c>.005?y="Profitable":c<-.005&&(y="Unprofitable");const w=r>0?1/r:1/0,P=e.averageProductProfitMargin_percent,O=e.adOrders>0?c/e.adOrders:0,k=e.adImpressions>0?e.adClicks/e.adImpressions*100:0,j=e.adClicks>0?e.totalAdSpend/e.adClicks:0,Z=e.adImpressions>0?e.totalAdSpend/e.adImpressions*1e3:0,X=e.adClicks>0?e.totalAdRevenue_fromAds/e.adClicks:0,J=e.adClicks>0?c/e.adClicks:0;a.aa_performancePeriod=e.performancePeriod_days,a.aa_selectedPeriodString=e.selectedPeriodString,a.aa_totalAdSpend_sum=e.totalAdSpend,a.aa_totalAdRevenue_sum=e.totalAdRevenue_fromAds,a.aa_adOrders_sum=e.adOrders,a.aa_netAdProfit_sum=c,a.aa_ROAS_kpr=i,a.aa_ACOS_kpr=d,a.aa_CVR_kpr=l,a.aa_CPA_kpr=s,a.aa_totalAdRevenue_prof=e.totalAdRevenue_fromAds,a.aa_totalAdSpend_prof=e.totalAdSpend,a.aa_COGS_prof=u,a.aa_totalCosts_prof=p,a.aa_netProfit_prof=c,a.aa_netProfitMargin_prof=f,a.aa_profitStatus_prof=y,a.aa_ROAS_prof=i,a.aa_breakevenROAS_prof=w,a.aa_ACOS_prof=d,a.aa_breakevenACOS_prof=P,a.aa_adImpressions_eng=e.adImpressions,a.aa_adClicks_eng=e.adClicks,a.aa_CTR_eng=k,a.aa_totalAdSpend_eng=e.totalAdSpend,a.aa_CPC_eng=j,a.aa_CPM_eng=Z,a.aa_RPC_eng=X,a.aa_PPC_eng=J,a.aa_adOrders_eng=e.adOrders,a.aa_CVR_eng=l,a.aa_AOV_eng=o,a.aa_CPA_eng=s,a.aa_profitPerSale_eng=O;const T=Math.max(0,e.totalOverallShopRevenue-e.totalAdRevenue_fromAds),C=Math.max(0,e.totalOverallShopOrders-e.adOrders),E=Math.max(0,e.totalShopVisits-e.adClicks),M=E>0?C/E*100:0,D=C>0?T/C:0,Q=e.totalOverallShopRevenue*r-e.totalAdSpend;return a.co_blendedROAS=e.totalAdSpend>0?e.totalOverallShopRevenue/e.totalAdSpend:0,a.co_overallShopNetProfitLoss=Q,a.co_TACoS_percent=e.totalOverallShopRevenue>0?e.totalAdSpend/e.totalOverallShopRevenue*100:0,a.co_percentRevenueFromAds=e.totalOverallShopRevenue>0?e.totalAdRevenue_fromAds/e.totalOverallShopRevenue*100:0,a.co_percentOrdersFromAds=e.totalOverallShopOrders>0?e.adOrders/e.totalOverallShopOrders*100:0,a.co_organicCVR_forOverview=M,a.co_adCVR_forOverview=l,a.co_organicAOV_forOverview=D,a.co_adAOV_forOverview=o,a.cdt_ad_visits=e.adClicks,a.cdt_ad_orders=e.adOrders,a.cdt_ad_cvr=l,a.cdt_ad_revenue=e.totalAdRevenue_fromAds,a.cdt_ad_aov=o,a.cdt_ad_revenuePercent=a.co_percentRevenueFromAds,a.cdt_ad_ordersPercent=a.co_percentOrdersFromAds,a.cdt_organic_visits=E,a.cdt_organic_orders=C,a.cdt_organic_cvr=M,a.cdt_organic_revenue=T,a.cdt_organic_aov=D,a.cdt_organic_revenuePercent=e.totalOverallShopRevenue>0?T/e.totalOverallShopRevenue*100:0,a.cdt_organic_ordersPercent=e.totalOverallShopOrders>0?C/e.totalOverallShopOrders*100:0,a.cdt_total_visits=e.totalShopVisits,a.cdt_total_orders=e.totalOverallShopOrders,a.cdt_total_cvr=e.totalShopVisits>0?e.totalOverallShopOrders/e.totalShopVisits*100:0,a.cdt_total_revenue=e.totalOverallShopRevenue,a.cdt_total_aov=e.totalOverallShopOrders>0?e.totalOverallShopRevenue/e.totalOverallShopOrders:0,a.m_budget_totalBudgetedForPeriod=e.dailyAdBudget*e.performancePeriod_days,a.m_budget_utilization_percent=a.m_budget_totalBudgetedForPeriod>0?e.totalAdSpend/a.m_budget_totalBudgetedForPeriod*100:0,ae(a),a}const V={profitable:{title:"Your Ads Appear Profitable!",description:"Great news! Based on your inputs, for every {currencySymbol}1 you've spent on ads, you're getting back approximately {formattedRoasValueInCurrency}. Your estimated Return on Ad Spend (ROAS) is {roas}x, which is above your breakeven ROAS of {breakevenRoas}x. This has resulted in an estimated net profit of {formattedNetProfit} for this period. Keep up the good work!"},breakeven:{title:"Your Ads Are Around Breakeven",description:"Based on your core inputs, your ads are covering their costs. For every {currencySymbol}1 spent on ads, you're getting back approximately {formattedRoasValueInCurrency}. Your estimated Return on Ad Spend (ROAS) of {roas}x is very close to your breakeven ROAS of {breakevenRoas}x, resulting in an estimated net financial impact of approximately {formattedNetResult} for this period. While not generating significant profit yet, these ads are helping maintain sales activity."},unprofitable:{title:"Your Ads Are Unprofitable",description:"Based on your inputs, it appears your ads might be operating at a loss. For every {currencySymbol}1 spent on ads, you're getting back approximately {formattedRoasValueInCurrency}. Your estimated Return on Ad Spend (ROAS) is {roas}x, which is below your breakeven ROAS of {breakevenRoas}x. This has led to an estimated net loss of {formattedNetLoss} for this period."}},h={slightlyProfitable:{title:"Ads are Barely Profitable",description:"Good progress! Your ads are generating positive returns with a ROAS of {roas}x. Every {currencySymbol}1 spent on advertising brings back {formattedRoasValueInCurrency} in sales. This beats your breakeven target of {breakevenRoas}x by {percentageAboveBreakeven}%, putting you in profitable territory. After covering all advertising costs, your campaigns delivered {formattedNetProfit} net profit this period from {adOrders} orders. You're on the right track, focus on optimizing these campaigns before scaling further. {budgetInsight}",minRequirements:{profit:25,orders:3,spend:75,days:3},roasMultiplier:{min:1.1,max:1.5}},mediumProfitable:{title:"Ads are Profitable!",description:"Excellent results! Your ads are generating strong returns with a ROAS of {roas}x. Every {currencySymbol}1 spent on advertising brings back {formattedRoasValueInCurrency} in sales. This crushes your breakeven target of {breakevenRoas}x by {percentageAboveBreakeven}%! After covering all advertising costs, your campaigns delivered a solid {formattedNetProfit} net profit this period from {adOrders} orders. Your ad strategy is working. {budgetInsight}",minRequirements:{profit:75,orders:5,spend:200,days:5},roasMultiplier:{min:1.5,max:2.5}},highlyProfitable:{title:"Ads are Crushing It!",description:"Outstanding performance! Your ads are delivering exceptional returns with a ROAS of {roas}x. Every {currencySymbol}1 spent on advertising brings back {formattedRoasValueInCurrency} in sales. This absolutely dominates your breakeven target of {breakevenRoas}x by {percentageAboveBreakeven}%! After covering all advertising costs, your campaigns generated an impressive {formattedNetProfit} net profit this period from {adOrders} orders. You've struck gold! {budgetInsight_highlyProfitable}",minRequirements:{profit:200,orders:10,spend:400,days:7},roasMultiplier:{min:2.5,max:1/0}},earlyProfitable:{title:"Ads Show Promise",description:"Early positive signs! Your ads are generating a ROAS of {roas}x, which beats your breakeven target of {breakevenRoas}x by {percentageAboveBreakeven}%. For every {currencySymbol}1 spent, you're getting back {formattedRoasValueInCurrency}. While you've only generated {formattedNetProfit} net profit from {adOrders} orders so far, this performance suggests your campaigns have potential. Continue monitoring for a few more days to confirm this trend before making major budget changes. {budgetInsight_early}",condition:"Good ROAS but doesn't meet minimum thresholds for other profitable tiers"}},S={perfectBreakeven:{title:"Ads Breaking Even",description:"Your current Return on Ad Spend is {roas}x, which is right at your breakeven target of {breakevenRoas}x. With essentially {formattedNetResult} net result this period from {adOrders} orders, your ads are covering their costs. For every {currencySymbol}1 spent, you're getting back {formattedRoasValueInCurrency}. While not generating direct profit, these campaigns are driving valuable sales velocity that can boost your Etsy search rankings organically. Small optimizations could push you into profitable territory. {budgetInsight_breakeven}",minRequirements:{maxAbsResult:25,minSpend:75,minDays:3},roasRange:{min:.95,max:1.05}},slightlyPositiveBreakeven:{title:"Ads Nearly Breaking Even (Slight Profit)",description:"Your current Return on Ad Spend is {roas}x, just above your breakeven target of {breakevenRoas}x by {percentageAboveBreakeven}%. With {formattedNetResult} net profit this period from {adOrders} orders, you're in minimal profit territory. For every {currencySymbol}1 spent, you're getting back {formattedRoasValueInCurrency}. These campaigns are covering costs while generating sales velocity. Focus on small optimizations to improve margins. {budgetInsight_breakeven}",minRequirements:{minResult:10,maxResult:75,minSpend:100,minDays:3},roasRange:{min:1.01,max:1.15}},slightlyNegativeBreakeven:{title:"Ads Nearly Breaking Even (Slight Loss)",description:"Your current Return on Ad Spend is {roas}x, just below your breakeven target of {breakevenRoas}x by {percentageBelowBreakeven}%. With {formattedNetResult} net loss this period from {adOrders} orders, you're very close to covering costs. For every {currencySymbol}1 spent, you're getting back {formattedRoasValueInCurrency}. While not profitable yet, these campaigns are generating sales velocity. Small optimizations should push you into profit. {budgetInsight_breakeven}",minRequirements:{minLoss:10,maxLoss:75,minSpend:100,minDays:3},roasRange:{min:.85,max:.99}},minimalBreakeven:{title:"Early Breakeven Results",description:"Your current Return on Ad Spend is {roas}x, which is close to your breakeven target of {breakevenRoas}x. For every {currencySymbol}1 spent, you're getting back {formattedRoasValueInCurrency}. With minimal financial impact so far ({formattedNetResult} from {adOrders} orders this period), it's still early to draw firm conclusions. These campaigns are generating sales velocity. Continue monitoring while making small optimizations. {budgetInsight_breakeven}",condition:"Close to breakeven but limited data or very small financial impact"}},b={earlyUnprofitable:{title:"Ads in Learning Phase (Loss)",description:"Your current Return on Ad Spend is {roas}x. For every {currencySymbol}1 invested in ads, your campaigns brought back {formattedRoasValueInCurrency} in revenue. This is below the {breakevenRoas}x ROAS needed to break even, resulting in a {formattedNetLoss} net loss this period from {adOrders} orders. Since you're in early testing with modest losses, these campaigns are still generating valuable sales velocity. Review recommendations for optimization. {budgetInsight_unprofitable}",minRequirements:{maxLoss:100,minSpend:50,maxDays:14},roasRange:{min:.6,max:1.1}},slightlyUnprofitable:{title:"Ads Slightly Unprofitable",description:"Your current Return on Ad Spend is {roas}x. For every {currencySymbol}1 invested in ads, your campaigns brought back {formattedRoasValueInCurrency} in revenue. This is just below the {breakevenRoas}x ROAS needed to break even, resulting in a {formattedNetLoss} net loss this period from {adOrders} orders. While not profitable yet, your ads are driving sales velocity. You're close to profitability. {budgetInsight_unprofitable}",minRequirements:{minLoss:50,maxLoss:300,minSpend:100},roasRange:{min:.85,max:1.1}},moderatelyUnprofitable:{title:"Ads Need Optimization (Unprofitable)",description:"Your current Return on Ad Spend is {roas}x. For every {currencySymbol}1 invested in ads, your campaigns brought back only {formattedRoasValueInCurrency} in revenue. This is below the {breakevenRoas}x ROAS needed to break even, resulting in a {formattedNetLoss} net loss this period from {adOrders} orders. Your ads are spending more than they're earning, but this is fixable. {budgetInsight_unprofitable}",minRequirements:{minLoss:100,maxLoss:1e3,minSpend:200},roasRange:{min:.5,max:.85}},severelyUnprofitable:{title:"Ads Losing Significant Money",description:"Your current Return on Ad Spend is {roas}x. For every {currencySymbol}1 invested in ads, your campaigns brought back only {formattedRoasValueInCurrency} in revenue. This is far below the {breakevenRoas}x ROAS needed to break even, resulting in a {formattedNetLoss} net loss this period from {adOrders} orders. These results suggest fundamental issues. {budgetInsight_unprofitable_severe}",minRequirements:{minLoss:300,minSpend:500},roasRange:{min:0,max:.6}},minimalUnprofitable:{title:"Early Testing Results (Loss)",description:"Your current Return on Ad Spend is {roas}x, which is below the {breakevenRoas}x needed to break even, resulting in a {formattedNetLoss} net loss this period from {adOrders} orders. For every {currencySymbol}1 spent, you're getting back {formattedRoasValueInCurrency}. With limited data so far, it's too early to draw firm conclusions. Continue testing. {budgetInsight_unprofitable}",condition:"Small losses or very limited data, not fitting other unprofitable tiers"}};function x(e,a,r,o,i=!1){if(a===0)return r>0?"Daily budget is currently 0. If you are running ads, setting a daily budget helps track utilization and control spend.":"Daily budget not set. Add a daily budget if you plan to run ads to track utilization.";const d=m(e,0);return i?e<80?`Your campaigns are using ${d}% of your budget. Since performance is excellent, consider if you can advertise more listings or refine targeting to help utilize your budget more fully on this profitable traffic.`:`Your campaigns are efficiently using ${d}% of your budget. To scale these fantastic results, you could consider a cautious budget increase.`:o?e<80?`Your campaigns are using ${d}% of your budget. With good performance, explore advertising more listings or ensuring your current ones have broad enough appeal to utilize more of the budget.`:`Your campaigns are using ${d}% of your budget. You could consider a gradual budget increase to capture more sales.`:e>80?`Your campaigns are using ${d}% of your budget. Focus on improving ROAS and core metrics before increasing spend. You might consider reducing the budget while optimizing to limit potential losses.`:`Your campaigns are using ${d}% of your budget. Prioritize optimizing campaign performance to improve profitability before considering budget changes.`}function _e(e,a,r,o,i,d){if(a===0||!isFinite(a))return"earlyProfitable";const s=e/a,l=h.highlyProfitable;if(s>=l.roasMultiplier.min&&r>=l.minRequirements.profit&&o>=l.minRequirements.orders&&i>=l.minRequirements.spend&&d>=l.minRequirements.days)return"highlyProfitable";const n=h.mediumProfitable;if(s>=n.roasMultiplier.min&&s<l.roasMultiplier.min&&r>=n.minRequirements.profit&&o>=n.minRequirements.orders&&i>=n.minRequirements.spend&&d>=n.minRequirements.days)return"mediumProfitable";const c=h.slightlyProfitable;return s>=c.roasMultiplier.min&&s<n.roasMultiplier.min&&r>=c.minRequirements.profit&&o>=c.minRequirements.orders&&i>=c.minRequirements.spend&&d>=c.minRequirements.days?"slightlyProfitable":r>.005?"earlyProfitable":null}function ye(e,a,r,o,i,d){const s=Math.abs(r),l=S.perfectBreakeven;if(e>=l.roasRange.min&&e<=l.roasRange.max&&s<=l.minRequirements.maxAbsResult&&o>=l.minRequirements.minSpend&&i>=l.minRequirements.minDays)return"perfectBreakeven";const n=S.slightlyPositiveBreakeven;if(e>=n.roasRange.min&&e<=n.roasRange.max&&r>=n.minRequirements.minResult&&r<=n.minRequirements.maxResult&&o>=n.minRequirements.minSpend&&i>=n.minRequirements.minDays)return"slightlyPositiveBreakeven";const c=S.slightlyNegativeBreakeven;return e>=c.roasRange.min&&e<=c.roasRange.max&&r<0&&s>=c.minRequirements.minLoss&&s<=c.minRequirements.maxLoss&&o>=c.minRequirements.minSpend&&i>=c.minRequirements.minDays?"slightlyNegativeBreakeven":e>=.85&&e<1.15&&s<50?"minimalBreakeven":null}function ve(e,a,r,o,i,d){if(r>=-.005)return null;const s=b.severelyUnprofitable;if(e>=s.roasRange.min&&e<s.roasRange.max&&Math.abs(r)>=s.minRequirements.minLoss&&o>=s.minRequirements.minSpend)return"severelyUnprofitable";const l=b.moderatelyUnprofitable;if(e>=l.roasRange.min&&e<l.roasRange.max&&Math.abs(r)>=l.minRequirements.minLoss&&Math.abs(r)<=l.minRequirements.maxLoss&&o>=l.minRequirements.minSpend)return"moderatelyUnprofitable";const n=b.slightlyUnprofitable;if(e>=n.roasRange.min&&e<n.roasRange.max&&Math.abs(r)>=n.minRequirements.minLoss&&Math.abs(r)<=n.minRequirements.maxLoss&&o>=n.minRequirements.minSpend)return"slightlyUnprofitable";const c=b.earlyUnprofitable;return e>=c.roasRange.min&&e<c.roasRange.max&&Math.abs(r)<=c.minRequirements.maxLoss&&o>=c.minRequirements.minSpend&&i<=c.minRequirements.maxDays?"earlyUnprofitable":"minimalUnprofitable"}function F(e,a){if(!e||!a)return"unknown";const r=e.aa_netAdProfit_sum,o=e.aa_ROAS_kpr,i=e.aa_breakevenROAS_prof;return o!==void 0&&i!==void 0&&i>0&&o<i*.6&&a.totalAdSpend>50&&a.performancePeriod_days>=7?"severelyUnprofitable":r!==void 0&&r>.005?"profitable":r!==void 0&&r<-.005?"unprofitable":r!==void 0?"breakeven":"unknown"}const Ae=[{id:"diveDeeperWithAdvancedMetrics",icon:{name:"magnifying-glass",style:"outline"},iconBgColor:"#475569",category:"Strategy & Insights",priority:100,noDismiss:!1,badgeText:"Deeper Insights",title:"Unlock Advanced Recommendations",descriptionFunction:(e,a)=>"You're viewing a summary based on core inputs. For more tailored recommendations and a complete understanding of your ad performance (like Click-Through Rate, Conversion Rate, and Cost Per Click), switch to 'Advanced View' and provide detailed ad data.",action:{label:"Switch to Advanced View",type:"function_call",target:"toggleAdvancedView"},condition:(e,a,r)=>r==="normal"},{id:"optimizeAdvertisedListingsWithAlura",icon:{name:"sparkles",style:"outline"},iconBgColor:"#4B5563",category:"Ad Performance",priority:90,noDismiss:!1,badgeText:"Increase ROAS",title:"Turn Off Underperforming Listings",descriptionFunction:(e,a)=>{const r=F(a,e);return r==="profitable"?"Your ads are generally performing well! To further boost your ROAS, use the Ads Optimizer to automatically identify and pause any individual listings that might be underperforming (e.g., low ROAS or high spend with few sales) within your successful campaigns. This ensures your budget is concentrated on the absolute top performers.":r==="breakeven"?"Some of your ads are just covering costs. The Ads Optimizer can help identify and pause listings that aren't quite hitting profitability or those spending without sales, freeing up budget for better performers.":"Improve your ad efficiency. The Ads Optimizer can automatically pause underperforming listings (e.g., those with high spend and no sales, or ROAS below breakeven) to redirect your budget towards what works and help refocus your strategy."},action:{label:"Use Ads Optimizer",type:"link",target:"https://app.alura.io/marketing/etsy-ads"},condition:(e,a)=>!0},{id:"optimizeAdBudgetToPerformance",icon:{name:"adjustments-horizontal",style:"outline"},iconBgColor:"#52525B",category:"Budget & Profit",priority:86,noDismiss:!1,badgeText:"Ad Spend Flow",title:"Adjust Your Ad Budget",descriptionFunction:(e,a)=>{const r=a.m_budget_utilization_percent,o=e.performancePeriod_days>0?e.totalAdSpend/e.performancePeriod_days:0,i=e.dailyAdBudget||0,d=e.currencySymbolPlaceholder||A(e.currencyCode)||"$",s=a.aa_ROAS_kpr,l=a.aa_breakevenROAS_prof;let n="breakeven";if(s!==void 0&&l!==void 0&&l>0?s>l*1.1?n="profitable":s<l*.9&&(n="unprofitable"):s!==void 0&&(l===0||l===void 0||!isFinite(l))&&s>0&&(n="profitable"),i===0&&e.totalAdSpend>0)return`You've spent ${d}${e.totalAdSpend.toFixed(2)} on ads, but your daily budget isn't set in Alura. To get precise budget utilization insights, please enter your Etsy daily ad budget.`;if(i===0)return"Enter your daily ad budget (as set on Etsy) to analyze how effectively your budget is being used.";const c=s!==void 0?s.toFixed(2)+"x":"N/A",u=`${d}${i.toFixed(2)}`,p=r!==void 0?r.toFixed(0)+"%":"N/A",f=`${d}${o.toFixed(2)}`;return r<70&&e.performancePeriod_days>3?n==="profitable"?`Your ads are profitable (ROAS: ${c}) but only using about ${p} of your ${u} daily budget. This is a missed sales opportunity! Consider advertising more well-optimized listings or ensuring current ones have broad appeal to help Etsy spend your budget on these winning ads.`:n==="unprofitable"?`Your ads are underperforming (ROAS: ${c}) and using about ${p} of your ${u} daily budget. While underspending limits current losses, your primary focus should be improving ad ROAS (optimizing listings, targeting) before attempting to increase spend.`:`Your ads are near breakeven (ROAS: ${c}), using about ${p} of your ${u} daily budget. Monitor closely: if ROAS improves, you'll want Etsy to spend more. If not, the current underspend is somewhat protective. Aim for consistent profitability first.`:r>115?n==="profitable"?`Great! Your ads are profitable (ROAS: ${c}) and Etsy is effectively spending slightly over your ${u} daily budget (approx. ${f}/day). Consider increasing your daily budget on Etsy to capture all available profitable sales.`:`Warning: Your ads are spending ${f}/day, exceeding your ${u} budget, but performance is poor (ROAS: ${c}). This accelerates losses. Urgently review your Etsy ad campaigns; consider reducing the budget or pausing ads with the lowest ROAS.`:n==="profitable"?`Your ads are profitable (ROAS: ${c}) and utilizing your budget well (approx. ${p} of ${u} daily). This is healthy. If consistently strong, you could test a small budget increase on Etsy for more sales.`:n==="unprofitable"?`Your ads are using your budget (approx. ${p} of ${u} daily) but are notably unprofitable (ROAS: ${c}). Focus on improving ROAS by optimizing listings or targeting. Spending your full budget on underperforming ads will reduce overall profit.`:`Your ads are spending well (approx. ${p} of ${u} daily) but are around breakeven (ROAS: ${c}). Prioritize optimizations to achieve clear profitability before considering any budget increases. Monitor which specific listings are performing best.`},action:{label:"Adjust Ads on Etsy",type:"link",target:"https://www.etsy.com/your/shops/me/advertising"},condition:(e,a,r)=>e.isAdvancedDataAvailable&&e.performancePeriod_days>1&&e.dailyAdBudget!==void 0},{id:"alertHighSpendZeroAdOrders",icon:{name:"exclamation-triangle",style:"solid"},iconBgColor:"#525252",category:"Budget & Profit",priority:96,noDismiss:!1,badgeText:"Sales Alert",title:"Ad Spend Without Sales",descriptionFunction:(e,a)=>{const r=e.currencySymbolPlaceholder||A(e.currencyCode)||"$",o=e.adClicks||0,i=(e.totalAdSpend||0).toFixed(2);return`You've spent ${r}${i} on ads, receiving ${o} clicks, but recorded zero orders directly from these ads. This requires immediate investigation. Review which listings are advertised, their pricing, shipping, photo quality, and overall content. Also, check the keyword relevance of your listing's tags and titles for items consuming the most ad spend, as mismatches can lead to costly, irrelevant clicks. It's advisable to review your Etsy Ads Dashboard now to identify which specific listings are spending without converting.`},action:{label:"Review Problem Ads",type:"link",target:"https://www.etsy.com/your/shops/me/advertising/listings"},condition:(e,a,r)=>e.isAdvancedDataAvailable&&e.totalAdSpend>100&&e.adOrders===0&&e.adClicks>10},{id:"analyzeTACOSAndSalesVelocity",icon:{name:"receipt-percent",style:"outline"},iconBgColor:"#57534E",category:"Strategy & Insights",priority:80,noDismiss:!1,badgeText:"Shop Profit Health",title:"Check Your Overall Shop Profit",descriptionFunction:(e,a)=>{const r=a.co_TACoS_percent!==void 0?a.co_TACoS_percent.toFixed(2):"N/A",o=a.co_percentRevenueFromAds!==void 0?a.co_percentRevenueFromAds.toFixed(1):"N/A",i=e.averageProductProfitMargin_percent||0,d=e.currencySymbolPlaceholder||A(e.currencyCode)||"$";return r==="N/A"||o==="N/A"||!e.totalOverallShopRevenue||e.totalOverallShopRevenue===0?"To evaluate how your ads contribute to overall sales and shop velocity, please ensure your 'Shop Stats Data' (total shop visits, orders, revenue) is entered for the same performance period. This unlocks your Total Advertising Cost of Sale (TACoS) insight.":`Ads drive ${o}% of your sales, and your TACoS (Total Ad Cost of Sale) is ${r}%. This ${r}% is your ad investment per ${d}100 of total shop revenue. Crucially, for overall shop profitability, this TACoS should be comfortably below your average ${i}% profit margin. Achieving this balance also typically boosts sales velocity, which can aid your organic search ranking.`},action:{label:"Analyze Shop Stats",type:"link",target:"https://app.alura.io/analytics/financial-reports"},condition:(e,a,r)=>e.isAdvancedDataAvailable&&e.totalOverallShopRevenue>0&&e.totalOverallShopOrders>0&&e.totalShopVisits>0&&a.co_TACoS_percent!==void 0&&a.co_percentRevenueFromAds!==void 0},{id:"setAdequateTestBudget",icon:{name:"beaker",style:"outline"},iconBgColor:"#EA580C",category:"Budget & Profit",priority:84,noDismiss:!1,badgeText:"Effective Testing",title:"Set Adequate Budget for Ad Testing",descriptionFunction:(e,a)=>{const r=e.currencySymbolPlaceholder||A(e.currencyCode)||"$";return`Effective ad testing often requires a sufficient daily budget. If your current budget is very low (e.g., under ${r}5) and your ads aren't severely unprofitable, consider setting it to at least ${r}5 on Etsy. This gives your ads a better chance to gather enough data for performance evaluation and for Etsy's algorithm to optimize delivery.`},action:{label:"Manage Budget on Etsy",type:"link",target:"https://www.etsy.com/your/shops/me/advertising"},condition:(e,a)=>{const r=F(a,e);return e.dailyAdBudget>0&&e.dailyAdBudget<5&&r!=="severelyUnprofitable"}},{id:"considerPausingAds",icon:{name:"pause-circle",style:"solid"},iconBgColor:"#CA8A04",category:"Budget & Profit",priority:95,noDismiss:!1,badgeText:"Minimize Losses",title:"Review Unprofitable Ads",descriptionFunction:(e,a)=>`Your ads are significantly unprofitable with a ROAS of ${a.aa_ROAS_kpr!==void 0&&isFinite(a.aa_ROAS_kpr)?a.aa_ROAS_kpr.toFixed(2):"N/A"}x. If this trend has persisted for over 7-14 days with sufficient spend (e.g., > $50-$100), consider pausing all ads via your Etsy dashboard to prevent further losses while you thoroughly re-evaluate your strategy.`,action:{label:"Go to Etsy Ads to Pause",type:"link",target:"https://www.etsy.com/your/shops/me/advertising"},condition:(e,a)=>{const r=a.aa_ROAS_kpr,o=a.aa_breakevenROAS_prof;return e.isAdvancedDataAvailable&&r!==void 0&&o!==void 0&&o>0&&r<o*.6&&e.totalAdSpend>50&&e.performancePeriod_days>=7}},{id:"focusOnHighPotentialListings",icon:{name:"star",style:"solid"},iconBgColor:"#65A30D",category:"Ad Performance",priority:75,noDismiss:!1,badgeText:"Maximize Winners",title:"Prioritize Top Listings for Ads",descriptionFunction:(e,a)=>"Some of your listings naturally perform better or have higher optimization scores. Consider focusing more of your ad budget on these high-potential items first, as they are more likely to convert profitably. You can identify these through Listing Analytics.",action:{label:"View Listing Analytics",type:"link",target:"https://app.alura.io/analytics/listings?filter=top-sellers"},condition:(e,a,r)=>e.isAdvancedDataAvailable&&e.dailyAdBudget>0&&e.dailyAdBudget<20&&e.totalAdSpend>20},{id:"advertiseAllInitially",icon:{name:"light-bulb",style:"outline"},iconBgColor:"#16A34A",category:"Strategy & Insights",priority:78,noDismiss:!1,badgeText:"Discover Winners",title:"Test All Listings Initially",descriptionFunction:(e,a)=>"When starting with Etsy Ads, or if you've added many new products, consider advertising all (or most) of your listings with a modest budget (e.g., $5-$10/day). This allows you to gather data on which items perform best with ads, helping you discover unexpected winners before narrowing your focus.",action:{label:"Manage Advertised Listings on Etsy",type:"link",target:"https://www.etsy.com/your/shops/me/advertising/listings"},condition:(e,a,r)=>(!e.isAdvancedDataAvailable||r==="normal")&&(e.totalAdSpend<50&&e.performancePeriod_days<=30||e.dailyAdBudget>0&&e.dailyAdBudget<=5)},{id:"discoverNewAdKeywords",icon:{name:"key",style:"outline"},iconBgColor:"#059669",category:"Strategy & Insights",priority:68,noDismiss:!1,badgeText:"Expand Reach",title:"Find New Ad Keywords",descriptionFunction:(e,a)=>"Your Etsy Ads are only as good as your listing tags. Since tags determine where your ads appear, optimizing them is key. Use the Keyword Finder to discover high-demand, relevant terms that can significantly improve your ad targeting and attract more buyers.",action:{label:"Find Keywords",type:"link",target:"https://app.alura.io/keyword-finder"},condition:(e,a,r)=>e.isAdvancedDataAvailable},{id:"reviewProfitabilityPerProduct",icon:{name:"currency-dollar",style:"outline"},iconBgColor:"#0D9488",category:"Budget & Profit",priority:82,noDismiss:!1,badgeText:"Profit Check",title:"Know Your Product Profit",descriptionFunction:(e,a)=>"Not all products have the same profit margin. Before heavily advertising a listing, use the Profit Calculator to understand its true profitability after all fees and ad costs. This helps ensure your ads are actually making you money on each sale.",action:{label:"Calculate Product Profit",type:"link",target:"https://app.alura.io/resources/calculator"},condition:(e,a)=>{const r=F(a,e);return r==="breakeven"||e.isAdvancedDataAvailable&&(r==="profitable"||r==="unprofitable")}},{id:"addressLowAdCVR",icon:{name:"cursor-arrow-rays",style:"outline"},iconBgColor:"#0891B2",category:"Ad Performance",priority:88,noDismiss:!1,badgeText:"Boost Sales",title:"Improve Ad Conversion Rate",descriptionFunction:(e,a)=>{if(e.isAdvancedDataAvailable&&a.aa_CVR_kpr!==void 0){const r=a.aa_CVR_kpr.toFixed(2);if(a.aa_CVR_kpr<1&&e.adClicks>20)return`Your ad Conversion Rate (CVR) is ${r}%, which is quite low. This means people click your ads but aren't buying. Focus on optimizing your listing pages: improve photos, clarify descriptions, check pricing, and ensure shipping is competitive. A/B testing can help pinpoint what to change.`;if(a.aa_CVR_kpr<2.5&&e.adClicks>10)return`Your ad Conversion Rate (CVR) is ${r}%. There's room for improvement! Review your listing pages for areas to enhance buyer confidence, such as detailed descriptions, multiple high-quality images/video, and clear policies. Consider A/B testing different elements.`}return"Ensure your product pages are fully optimized to turn ad clicks into sales. High-quality photos, clear descriptions, competitive pricing, and reasonable shipping are key to improving your Conversion Rate."},action:{label:"A/B Test Listing Elements",type:"link",target:"https://app.alura.io/operations/ab-tests"},condition:(e,a,r)=>e.isAdvancedDataAvailable&&a.aa_CVR_kpr!==void 0&&e.adClicks>10&&a.aa_CVR_kpr<2.5},{id:"addVideosToBoostCTR",icon:{name:"video-camera",style:"outline"},iconBgColor:"#0284C7",category:"Ad Performance",priority:70,noDismiss:!1,badgeText:"Increase CTR",title:"Add Listing Videos",descriptionFunction:(e,a)=>{let r="Listings with videos can get up to 2x more sales on Etsy and tend to increase Click-Through Rates (CTR) as they auto-play on hover. ";if(e.isAdvancedDataAvailable&&a.aa_CTR_eng!==void 0){const o=a.aa_CTR_eng.toFixed(2);a.aa_CTR_eng<1?r=`Your current average ad Click-Through Rate (CTR) is ${o}%. Improving this can bring more potential buyers. Listings with videos often see higher engagement. `:r=`Your average ad Click-Through Rate (CTR) is ${o}%. To potentially boost this further, consider adding videos. `}return r+"Use the 1-click video generator to easily add videos to your advertised listings and enhance their appeal."},action:{label:"Create Listing Videos",type:"link",target:"https://app.alura.io/optimization/listings?filter=missing-video"},condition:(e,a)=>!0},{id:"abTestPrimaryImageForCTR",icon:{name:"photo",style:"outline"},iconBgColor:"#2563EB",category:"Ad Performance",priority:65,noDismiss:!1,badgeText:"Improve CTR",title:"A/B Test Primary Images",descriptionFunction:(e,a)=>{let r="Your primary image is crucial for attracting clicks. ";if(e.isAdvancedDataAvailable&&a.aa_CTR_eng!==void 0){const o=a.aa_CTR_eng.toFixed(2);r+=`Your current ad CTR is ${o}%. `}return r+="Use A/B Testing to experiment with different primary images for your key advertised listings to find out what captures more attention and boosts your CTR.",r},action:{label:"Start A/B Test",type:"link",target:"https://app.alura.io/operations/ab-tests"},condition:(e,a)=>!0},{id:"abTestPricingForCVR",icon:{name:"tag",style:"outline"},iconBgColor:"#4F46E5",category:"Ad Performance",priority:60,noDismiss:!1,badgeText:"Boost CVR",title:"A/B Test Listing Prices",descriptionFunction:(e,a)=>{let r="Price is a major factor in a buyer's decision. ";if(e.isAdvancedDataAvailable&&a.aa_CVR_kpr!==void 0){const o=a.aa_CVR_kpr.toFixed(2);a.aa_CVR_kpr<2&&a.aa_CVR_kpr>0?r+=`Your current ad Conversion Rate (CVR) is ${o}%. `:a.aa_CVR_kpr===0&&e.adClicks>10&&(r+=`Your ads are getting clicks but not converting (CVR: ${o}%). `)}return r+="Use A/B Testing to experiment with different price points for your advertised listings. This can help you find the sweet spot that maximizes sales and profit.",r},action:{label:"Start A/B Test",type:"link",target:"https://app.alura.io/operations/ab-tests"},condition:(e,a)=>!0},{id:"optimizeAdKeywordsInEtsy",icon:{name:"wrench-screwdriver",style:"outline"},iconBgColor:"#7C3AED",category:"Strategy & Insights",priority:80,noDismiss:!1,badgeText:"Refine Targeting",title:"Optimize Ad Keywords",descriptionFunction:(e,a)=>{let r="Review the 'Detailed stats' for your advertised listings on Etsy. ";const o=e.currencySymbolPlaceholder||A(e.currencyCode)||"$";return e.isAdvancedDataAvailable&&e.totalAdSpend>0&&(r+=`You've spent ${o}${e.totalAdSpend.toFixed(2)} on ads. `),r+="Identify search terms (keywords) that are driving clicks but have low sales or a ROAS below your breakeven point. Consider pausing these specific keywords within Etsy's ad dashboard to focus your budget on terms that convert profitably. Start by checking listings with the highest ad spend.",r},action:{label:"View Etsy Ads Listing Stats",type:"link",target:"https://www.etsy.com/your/shops/me/advertising/listings"},condition:(e,a)=>e.isAdvancedDataAvailable&&e.totalAdSpend>10}];function be(e,a,r,o=new Set){return!e||!a?[]:Ae.filter(i=>{if(o.has(i.id)&&!i.noDismiss)return!1;try{return typeof i.condition=="function"?i.condition(e,a,r):!0}catch(d){return console.error(`Error evaluating condition for recommendation '${i.id}':`,d),!1}})}function he(e,a){const r=e.aa_netAdProfit_sum,o=e.aa_ROAS_kpr,i=e.aa_breakevenROAS_prof,d=a.currencyCode,s=A(d),l=o;let n={title:"Performance Analysis",description:"Enter your ad data to see detailed insights.",statusClass:"neutral"};if(!a.isAdvancedDataAvailable)r>.005?n={...V.profitable,statusClass:"profitable"}:r<-.005?n={...V.unprofitable,statusClass:"not-profitable"}:n={...V.breakeven,statusClass:"breaking-even"},n.description=n.description.replace(/{currencySymbol}/g,s).replace(/{formattedRoasValueInCurrency}/g,g(l,d)).replace(/{roas}/g,m(o,2,!1,"")).replace(/{breakevenRoas}/g,isFinite(i)?m(i,2,!1,""):"N/A").replace(/{formattedNetProfit}/g,g(r,d,!0)).replace(/{formattedNetResult}/g,g(r,d,!0)).replace(/{formattedNetLoss}/g,g(r,d,!0));else{const c=e.m_budget_utilization_percent,u=a.adOrders;let p=null;if(r>.005){if(p=_e(o,i,r,u,a.totalAdSpend,a.performancePeriod_days),p&&h[p]){const f=h[p],y=x(c,a.dailyAdBudget,a.totalAdSpend,!0,p==="highlyProfitable");n.title=f.title,n.description=f.description.replace(/{roas}/g,m(o,2,!1,"")).replace(/{currencySymbol}/g,s).replace(/{formattedRoasValueInCurrency}/g,g(l,d)).replace(/{breakevenRoas}/g,isFinite(i)?m(i,2,!1,""):"N/A").replace(/{percentageAboveBreakeven}/g,i>0&&isFinite(i)?v(Math.round((o/i-1)*100)):"0").replace(/{formattedNetProfit}/g,g(r,d,!0)).replace(/{adOrders}/g,v(u)).replace(/{budgetInsight}/g,y).replace(/{budgetInsight_highlyProfitable}/g,y).replace(/{budgetInsight_early}/g,y),n.statusClass="profitable"}}else if(r<-.005){if(p=ve(o,i,r,a.totalAdSpend,a.performancePeriod_days),p&&b[p]){const f=b[p],y=x(c,a.dailyAdBudget,a.totalAdSpend,!1);n.title=f.title,n.description=f.description.replace(/{roas}/g,m(o,2,!1,"")).replace(/{currencySymbol}/g,s).replace(/{formattedRoasValueInCurrency}/g,g(l,d)).replace(/{breakevenRoas}/g,isFinite(i)?m(i,2,!1,""):"N/A").replace(/{formattedNetLoss}/g,g(r,d,!0)).replace(/{adOrders}/g,v(u)).replace(/{budgetInsight_unprofitable}/g,y).replace(/{budgetInsight_unprofitable_severe}/g,y),n.statusClass="not-profitable"}}else if(p=ye(o,i,r,a.totalAdSpend,a.performancePeriod_days),p&&S[p]){const f=S[p],y=x(c,a.dailyAdBudget,a.totalAdSpend,!1);n.title=f.title,n.description=f.description.replace(/{roas}/g,m(o,2,!1,"")).replace(/{currencySymbol}/g,s).replace(/{formattedRoasValueInCurrency}/g,g(l,d)).replace(/{breakevenRoas}/g,isFinite(i)?m(i,2,!1,""):"N/A").replace(/{formattedNetResult}/g,g(r,d,!0)).replace(/{adOrders}/g,v(u)).replace(/{percentageAboveBreakeven}/g,i>0&&isFinite(i)&&o>i?v(Math.round((o/i-1)*100)):"0").replace(/{percentageBelowBreakeven}/g,i>0&&isFinite(i)&&o<i?v(Math.round((1-o/i)*100)):"0").replace(/{budgetInsight_breakeven}/g,y),n.statusClass="breaking-even"}if(!p||n.title==="Performance Analysis"){const f=x(e.m_budget_utilization_percent,a.dailyAdBudget,a.totalAdSpend,r>.005,r>.005&&o>h.mediumProfitable.roasMultiplier.min*(isFinite(i)&&i>0?i:1.5));r>.005?(n.title="Ads Profitable (General)",n.description=`Your ads are profitable with a ROAS of ${m(o,2,!1,"x")} and net profit of ${g(r,d,!0)}. Review detailed metrics for more insights. ${f}`,n.statusClass="profitable"):r<-.005?(n.title="Ads Unprofitable (General)",n.description=`Your ads are unprofitable with a ROAS of ${m(o,2,!1,"x")} and net loss of ${g(r,d,!0)}. Review detailed metrics to identify areas for improvement. ${f}`,n.statusClass="not-profitable"):(n.title="Ads Breaking Even (General)",n.description=`Your ads are breaking even with a ROAS of ${m(o,2,!1,"x")}. ${f}`,n.statusClass="breaking-even")}}return n}function Ce(e){return e.currencySymbolPlaceholder||A(e.currencyCode)||"$"}async function K(e,a,r,o,i,d){if(!t.recommendationsSection)return;const s=be(e,a,r,i);Se(s,o,d.onFilterClick);const l=o==="View all"||!o?s:s.filter(n=>n.category===o);if(await Re(l,e,a,d.onActionClick,d.onDismissClick),t.recommendationsEmptyState&&t.recommendationOutputArea){const n=t.recommendationOutputArea.hasChildNodes();l.length>0&&n?(t.recommendationsEmptyState.style.display="none",t.recommendationOutputArea.style.display="block"):(t.recommendationsEmptyState.style.display="flex",t.recommendationOutputArea.style.display="none",s.length===0&&t.categoryFilters&&(t.categoryFilters.innerHTML=""))}}function Se(e,a,r){if(!t.categoryFilters||(t.categoryFilters.innerHTML="",e.length===0))return;const o=new Set;e.forEach(s=>{s.category&&o.add(s.category)});const i=(s,l=!1)=>{const n=document.createElement("button");n.textContent=s,n.className="filter-badge-base";const c=l?a==="View all"||!a:a===s;n.classList.add(c?"filter-badge-active":"filter-badge-inactive"),n.dataset.category=s,n.addEventListener("click",()=>r(s)),t.categoryFilters.appendChild(n)};i("View all",!0),["Budget & Profit","Ad Performance","Strategy & Insights"].forEach(s=>{o.has(s)&&i(s)})}async function Re(e,a,r,o,i){if(t.recommendationOutputArea&&(t.recommendationOutputArea.innerHTML="",e.length!==0))for(const d of e){const s=document.createElement("div");s.className="recommendation-card-wrapper bg-p-gray-25 border border-p-gray-200 rounded-xl shadow-custom-xs";const l=typeof d.titleFunction=="function"?d.titleFunction(a,r):d.title;let n=typeof d.descriptionFunction=="function"?d.descriptionFunction(a,r):d.description||"";const c=typeof d.badgeTextFunction=="function"?d.badgeTextFunction(a,r):d.badgeText||"",u=Ce(a);n=n.replace(/{currencySymbol}/g,u),r&&r.aa_ROAS_kpr!==void 0&&(n=n.replace(/{roas}x/g,`${m(r.aa_ROAS_kpr,2)}x`),n=n.replace(/{roas}/g,m(r.aa_ROAS_kpr,2))),r&&r.aa_CTR_eng!==void 0&&(n=n.replace(/{CTR}/g,m(r.aa_CTR_eng,2))),r&&r.aa_CVR_kpr!==void 0&&(n=n.replace(/{CVR}/g,m(r.aa_CVR_kpr,2)));const p=d.icon;let f="";p&&typeof fetchIconSvgString=="function"?f=await fetchIconSvgString(p.name,p.style):f='<svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" /></svg>';const w=`<div class="icon-display" style="--icon-bg-color: ${d.iconBgColor||"#667085"};">${f}</div>`;let P="";if(d.action&&(P=`
                <div class="p-4 border-t border-p-gray-200 flex justify-end items-center space-x-4">
                    ${d.noDismiss?"":`<button class="text-sm font-semibold text-p-gray-600 hover:text-p-gray-700 active:text-p-gray-800 transition-colors duration-200" data-rec-id="${d.id}" data-action-type="dismiss">Dismiss</button>`}
                    <button class="text-sm font-semibold text-p-primary-700 hover:text-p-primary-600 active:text-p-primary-800 transition-colors duration-200" data-rec-id="${d.id}" data-action-type="primary" data-action-kind="${d.action.type}" data-action-target="${d.action.target}">${d.action.label}</button>
                </div>`),s.innerHTML=`
            <div class="px-4 py-5">
                <div class="flex items-start space-x-3 items-center">
                    ${w}
                    <div class="flex-grow">
                        <div class="flex items-center space-x-2 mb-1">
                            <h5 class="text-base font-medium text-p-gray-900">${l}</h5>
                            ${c?`<span class="recommendation-title-badge-style">${c}</span>`:""}
                        </div>
                    </div>
                </div>
                <div class="mt-2">
                    <p class="text-sm text-p-gray-600">${n}</p>
                </div>
            </div>
            ${P}
        `,d.action){const O=s.querySelector('button[data-action-type="dismiss"]');O&&O.addEventListener("click",()=>i(d.id));const k=s.querySelector('button[data-action-type="primary"]');k&&k.addEventListener("click",()=>o(d.id,d.action.type,d.action.target))}t.recommendationOutputArea.appendChild(s)}}function Pe(e,a,r){const o=a.currencyCode;t.roasStatValue&&(t.roasStatValue.textContent=m(e.aa_ROAS_kpr,2,!1,"x")),t.breakevenRoasStatValue&&(t.breakevenRoasStatValue.textContent=isFinite(e.aa_breakevenROAS_prof)?m(e.aa_breakevenROAS_prof,2,!1,"x"):"-"),t.netAdProfitStatValue&&(t.netAdProfitStatValue.textContent=g(e.aa_netAdProfit_sum,o,!0));const i=he(e,a);if(t.profitabilityMessageTitle&&(t.profitabilityMessageTitle.textContent=i.title),t.profitabilityMessageText&&(t.profitabilityMessageText.innerHTML=i.description),t.profitabilityStatusBadge){const s=t.profitabilityStatusBadge;s.textContent=i.statusClass.charAt(0).toUpperCase()+i.statusClass.slice(1).replace("-"," ");const l="inline-flex items-center whitespace-nowrap mix-blend-multiply rounded-full min-h-[22px] px-[7px] py-px text-xs leading-18px gap-x-1.5";i.statusClass==="profitable"?s.className=`${l} border border-p-success-200 bg-p-success-50 text-p-success-700`:i.statusClass==="not-profitable"?s.className=`${l} border border-p-error-200 bg-p-error-50 text-p-error-700`:i.statusClass==="breaking-even"?s.className=`${l} border border-p-warning-200 bg-p-warning-50 text-p-warning-700`:s.className=`${l} border border-p-gray-200 bg-p-gray-50 text-p-gray-700`,s.classList.remove("hidden")}if(t.profitabilityMessageCard){const s=t.profitabilityMessageCard,l="p-4 rounded-lg mt-4 shadow-custom-xs";i.statusClass==="profitable"?s.className=`${l} bg-p-success-25 border border-p-success-200 text-p-success-700`:i.statusClass==="not-profitable"?s.className=`${l} bg-p-error-25 border border-p-error-200 text-p-error-700`:i.statusClass==="breaking-even"?s.className=`${l} bg-p-warning-25 border border-p-warning-200 text-p-warning-700`:s.className=`${l} bg-p-gray-25 border border-p-gray-200 text-p-gray-700`}if(t.performancePeriodDropdown&&t.aa_performancePeriod){const s=t.performancePeriodDropdown.options[t.performancePeriodDropdown.selectedIndex]?.text||"Selected Period";t.aa_performancePeriod.textContent=`${s} (${v(e.aa_performancePeriod)} days)`}if(t.aa_totalAdSpend_sum&&(t.aa_totalAdSpend_sum.textContent=g(e.aa_totalAdSpend_sum,o)),t.aa_totalAdRevenue_sum&&(t.aa_totalAdRevenue_sum.textContent=g(e.aa_totalAdRevenue_sum,o)),t.aa_adOrders_sum&&(t.aa_adOrders_sum.textContent=v(e.aa_adOrders_sum)),t.aa_netAdProfit_sum&&(t.aa_netAdProfit_sum.textContent=g(e.aa_netAdProfit_sum,o,!0)),t.aa_ROAS_kpr&&(t.aa_ROAS_kpr.textContent=m(e.aa_ROAS_kpr,2,!1,"x")),t.aa_ACOS_kpr&&(t.aa_ACOS_kpr.textContent=_(e.aa_ACOS_kpr)),t.aa_CVR_kpr&&(t.aa_CVR_kpr.textContent=_(e.aa_CVR_kpr)),t.aa_CPA_kpr&&(t.aa_CPA_kpr.textContent=g(e.aa_CPA_kpr,o)),t.aa_totalAdRevenue_prof&&(t.aa_totalAdRevenue_prof.textContent=g(e.aa_totalAdRevenue_prof,o)),t.aa_totalAdSpend_prof&&(t.aa_totalAdSpend_prof.textContent=g(e.aa_totalAdSpend_prof,o)),t.aa_COGS_prof&&(t.aa_COGS_prof.textContent=g(e.aa_COGS_prof,o)),t.aa_totalCosts_prof&&(t.aa_totalCosts_prof.textContent=g(e.aa_totalCosts_prof,o)),t.aa_netProfit_prof&&(t.aa_netProfit_prof.textContent=g(e.aa_netProfit_prof,o,!0)),t.aa_netProfitMargin_prof&&(t.aa_netProfitMargin_prof.textContent=_(e.aa_netProfitMargin_prof)),t.aa_profitStatus_prof&&(t.aa_profitStatus_prof.textContent=e.aa_profitStatus_prof),t.aa_ROAS_prof&&(t.aa_ROAS_prof.textContent=m(e.aa_ROAS_prof,2,!1,"x")),t.aa_breakevenROAS_prof&&(t.aa_breakevenROAS_prof.textContent=isFinite(e.aa_breakevenROAS_prof)?m(e.aa_breakevenROAS_prof,2,!1,"x"):"-"),t.aa_ACOS_prof&&(t.aa_ACOS_prof.textContent=_(e.aa_ACOS_prof)),t.aa_breakevenACOS_prof&&(t.aa_breakevenACOS_prof.textContent=_(e.aa_breakevenACOS_prof)),t.aa_adImpressions_eng&&(t.aa_adImpressions_eng.textContent=v(e.aa_adImpressions_eng)),t.aa_adClicks_eng&&(t.aa_adClicks_eng.textContent=v(e.aa_adClicks_eng)),t.aa_CTR_eng&&(t.aa_CTR_eng.textContent=_(e.aa_CTR_eng)),t.aa_totalAdSpend_eng&&(t.aa_totalAdSpend_eng.textContent=g(e.aa_totalAdSpend_eng,o)),t.aa_CPC_eng&&(t.aa_CPC_eng.textContent=g(e.aa_CPC_eng,o)),t.aa_CPM_eng&&(t.aa_CPM_eng.textContent=g(e.aa_CPM_eng,o)),t.aa_RPC_eng&&(t.aa_RPC_eng.textContent=g(e.aa_RPC_eng,o)),t.aa_PPC_eng&&(t.aa_PPC_eng.textContent=g(e.aa_PPC_eng,o,!0)),t.aa_adOrders_eng&&(t.aa_adOrders_eng.textContent=v(e.aa_adOrders_eng)),t.aa_CVR_eng&&(t.aa_CVR_eng.textContent=_(e.aa_CVR_eng)),t.aa_AOV_eng&&(t.aa_AOV_eng.textContent=g(e.aa_AOV_eng,o)),t.aa_CPA_eng&&(t.aa_CPA_eng.textContent=g(e.aa_CPA_eng,o)),t.aa_profitPerSale_eng&&(t.aa_profitPerSale_eng.textContent=g(e.aa_profitPerSale_eng,o,!0)),t.co_blendedROAS&&(t.co_blendedROAS.textContent=m(e.co_blendedROAS,2,!1,"x")),t.co_overallShopNetProfitLoss&&(t.co_overallShopNetProfitLoss.textContent=g(e.co_overallShopNetProfitLoss,o,!0)),t.co_TACoS_percent&&(t.co_TACoS_percent.textContent=_(e.co_TACoS_percent)),t.co_percentRevenueFromAds&&(t.co_percentRevenueFromAds.textContent=_(e.co_percentRevenueFromAds)),t.co_percentOrdersFromAds&&(t.co_percentOrdersFromAds.textContent=_(e.co_percentOrdersFromAds)),t.co_combinedConversionRate&&(t.co_combinedConversionRate.textContent=`Organic: ${_(e.co_organicCVR_forOverview)} | Ads: ${_(e.co_adCVR_forOverview)}`),t.co_combinedAOV&&(t.co_combinedAOV.textContent=`Organic: ${g(e.co_organicAOV_forOverview,o)} | Ads: ${g(e.co_adAOV_forOverview,o)}`),t.co_adSpendToOverallGrossProfitRatio_percent&&(t.co_adSpendToOverallGrossProfitRatio_percent.textContent=_(e.co_adSpendToOverallGrossProfitRatio_percent)),K(a,e,r.currentView,r.currentCategoryFilter,r.dismissedRecommendationIds,r.recommendationEventCallbacks).catch(s=>console.error("Error rendering recommendations from updateDOM:",s)),["cdt_ad_visits","cdt_organic_visits","cdt_total_visits","cdt_ad_orders","cdt_organic_orders","cdt_total_orders","cdt_ad_cvr","cdt_organic_cvr","cdt_total_cvr","cdt_ad_revenue","cdt_organic_revenue","cdt_total_revenue","cdt_ad_aov","cdt_organic_aov","cdt_total_aov","cdt_ad_revenuePercent","cdt_organic_revenuePercent","cdt_ad_ordersPercent","cdt_organic_ordersPercent"].forEach(s=>{if(t[s]&&e[s]!==void 0){let l=e[s];s.endsWith("_cvr")||s.endsWith("Percent")?t[s].textContent=_(l):s.endsWith("_revenue")||s.endsWith("_aov")?t[s].textContent=g(l,o):t[s].textContent=v(l)}}),t.budgetUtilizationText&&(a.dailyAdBudget>0&&a.performancePeriod_days>0?t.budgetUtilizationText.textContent=`You've utilized ${m(e.m_budget_utilization_percent,1)}% of your ad budget for this period, spending ${g(a.totalAdSpend,o)} out of a planned ${g(e.m_budget_totalBudgetedForPeriod,o)}.`:t.budgetUtilizationText.textContent="Enter your Daily Budget and Performance Period to see budget utilization."),t.budgetUtilizationProgressBarFill){const s=Math.min(100,Math.max(0,e.m_budget_utilization_percent));t.budgetUtilizationProgressBarFill.style.width=`${s}%`,t.budgetUtilizationProgressBarFill.classList.toggle("over-budget",e.m_budget_utilization_percent>100)}t.budgetUtilizationPercentageOnBar&&(t.budgetUtilizationPercentageOnBar.textContent=`${m(e.m_budget_utilization_percent,1)}%`)}function H(){const e="-",a=t.currencySymbol?.value||"USD";[t.roasStatValue,t.breakevenRoasStatValue,t.netAdProfitStatValue,t.aa_performancePeriod,t.aa_totalAdSpend_sum,t.aa_totalAdRevenue_sum,t.aa_adOrders_sum,t.aa_netAdProfit_sum,t.aa_ROAS_kpr,t.aa_ACOS_kpr,t.aa_CVR_kpr,t.aa_CPA_kpr,t.aa_totalAdRevenue_prof,t.aa_totalAdSpend_prof,t.aa_COGS_prof,t.aa_totalCosts_prof,t.aa_netProfit_prof,t.aa_netProfitMargin_prof,t.aa_profitStatus_prof,t.aa_ROAS_prof,t.aa_breakevenROAS_prof,t.aa_ACOS_prof,t.aa_breakevenACOS_prof,t.aa_adImpressions_eng,t.aa_adClicks_eng,t.aa_CTR_eng,t.aa_totalAdSpend_eng,t.aa_CPC_eng,t.aa_CPM_eng,t.aa_RPC_eng,t.aa_PPC_eng,t.aa_adOrders_eng,t.aa_CVR_eng,t.aa_AOV_eng,t.aa_CPA_eng,t.aa_profitPerSale_eng,t.co_blendedROAS,t.co_overallShopNetProfitLoss,t.co_TACoS_percent,t.co_percentRevenueFromAds,t.co_percentOrdersFromAds,t.cdt_ad_visits,t.cdt_organic_visits,t.cdt_total_visits,t.cdt_ad_orders,t.cdt_organic_orders,t.cdt_total_orders,t.cdt_ad_cvr,t.cdt_organic_cvr,t.cdt_total_cvr,t.cdt_ad_revenue,t.cdt_organic_revenue,t.cdt_total_revenue,t.cdt_ad_aov,t.cdt_organic_aov,t.cdt_total_aov,t.cdt_ad_revenuePercent,t.cdt_organic_revenuePercent,t.cdt_ad_ordersPercent,t.cdt_organic_ordersPercent].forEach(o=>{o&&(o.textContent=e)}),t.profitabilityStatusBadge&&(t.profitabilityStatusBadge.textContent="",t.profitabilityStatusBadge.className="inline-flex items-center whitespace-nowrap mix-blend-multiply rounded-full min-h-[22px] px-[7px] py-px text-xs leading-18px gap-x-1.5 border border-p-gray-200 bg-p-gray-50 text-p-gray-700",t.profitabilityStatusBadge.classList.add("hidden")),t.profitabilityMessageTitle&&(t.profitabilityMessageTitle.textContent="Performance Analysis"),t.profitabilityMessageText&&(t.profitabilityMessageText.innerHTML="Enter your ad data to see detailed insights."),t.profitabilityMessageCard&&(t.profitabilityMessageCard.className="p-4 rounded-lg mt-4 shadow-custom-xs bg-p-gray-25 border border-p-gray-200 text-p-gray-700"),t.co_combinedConversionRate&&(t.co_combinedConversionRate.textContent="Organic: - | Ads: -"),t.co_combinedAOV&&(t.co_combinedAOV.textContent=`Organic: ${g(NaN,a)} | Ads: ${g(NaN,a)}`),t.budgetUtilizationText&&(t.budgetUtilizationText.textContent="Enter your Daily Budget and Performance Period to see budget utilization."),t.budgetUtilizationProgressBarFill&&(t.budgetUtilizationProgressBarFill.style.width="0%",t.budgetUtilizationProgressBarFill.classList.remove("over-budget")),t.budgetUtilizationPercentageOnBar&&(t.budgetUtilizationPercentageOnBar.textContent="0%"),t.recommendationsEmptyState&&(t.recommendationsEmptyState.style.display="flex"),t.recommendationOutputArea&&(t.recommendationOutputArea.innerHTML="",t.recommendationOutputArea.style.display="none"),t.categoryFilters&&(t.categoryFilters.innerHTML="")}const $={onFilterClick:e=>Oe(e),onActionClick:(e,a,r)=>xe(e,a,r),onDismissClick:e=>ke(e)};function R(){const e=ge(),a=fe(e),r=G(),o=ie(),i=de();if(!(t.totalAdSpend&&t.totalAdSpend.value.trim()!==""&&t.totalAdRevenue_fromAds&&t.totalAdRevenue_fromAds.value.trim()!==""&&t.averageProductProfitMargin_percent&&t.averageProductProfitMargin_percent.value.trim()!=="")){t.profitabilityMessageCard&&(t.profitabilityMessageCard.style.display="none"),H(),K(e,null,r,o,i,$).catch(s=>console.error("Error rendering recommendations on core input check:",s));return}t.profitabilityMessageCard&&(t.profitabilityMessageCard.style.display="block"),Pe(a,e,{currentView:r,currentCategoryFilter:o,dismissedRecommendationIds:i,recommendationEventCallbacks:$})}const L=le(R,350);function I(e){ue(e);const a=e==="advanced";t.normalInputsContainer&&(t.normalInputsContainer.style.display=a?"none":"grid"),t.advancedInputsContainer&&(t.advancedInputsContainer.style.display=a?"block":"none"),t.advertisingAnalysisSectionWrapper&&(t.advertisingAnalysisSectionWrapper.style.display=a?"block":"none"),t.organicVsAdComparisonSectionWrapper&&(t.organicVsAdComparisonSectionWrapper.style.display=a?"block":"none"),t.budgetUtilizationSectionWrapper&&(t.budgetUtilizationSectionWrapper.style.display=a?"block":"none"),t.exportSection&&(t.exportSection.style.display=a?"flex":"none"),t.toggleNormalViewButton&&t.toggleNormalViewButton.classList.toggle("active",!a),t.toggleAdvancedViewButton&&t.toggleAdvancedViewButton.classList.toggle("active",a),a&&pe(),R()}function B(e,a,r){const o=e.dataset.tabTarget;r.forEach(i=>{i&&(i.classList.remove("active"),i.classList.add("hidden"),i.id===o&&(i.classList.add("active"),i.classList.remove("hidden")))}),a.forEach(i=>{i&&i.classList.remove("active")}),e&&e.classList.add("active")}function Oe(e){ne(e),R()}function ke(e){se(e),R()}function xe(e,a,r){a==="link"?window.open(r,"_blank"):a==="function_call"?r==="toggleAdvancedView"?I("advanced"):console.warn(`Unhandled function_call target: ${r} for recommendation: ${e}`):console.warn(`Unknown action type: ${a} for recommendation: ${e}`)}const N={totalAdSpend:"Total Ad Spend (Input)",totalAdRevenue_fromAds:"Total Ad Revenue from Ads (Input)",averageProductProfitMargin_percent:"Average Product Profit Margin % (Input)",adImpressions:"Ad Impressions/Views (Input)",adClicks:"Ad Clicks (Input)",adOrders:"Ad Orders (Input)",dailyAdBudget:"Daily Ad Budget (Input)",performancePeriod_days:"Performance Period (Days)",selectedPeriodString:"Selected Performance Period",currencyCode:"Currency Code",totalOverallShopRevenue:"Total Overall Shop Revenue (Input)",totalOverallShopOrders:"Total Overall Shop Orders (Input)",totalShopVisits:"Total Shop Visits (Input)",isAdvancedDataAvailable:"Is Advanced Data Available (Calculated Flag)",aa_performancePeriod:"Ad Analysis - Performance Period (Calculated Days)",aa_selectedPeriodString:"Ad Analysis - Selected Performance Period Name",aa_totalAdSpend_sum:"Ad Analysis - Total Ad Spend (Summary)",aa_totalAdRevenue_sum:"Ad Analysis - Total Ad Revenue (Summary)",aa_adOrders_sum:"Ad Analysis - Orders from Ads (Summary)",aa_netAdProfit_sum:"Ad Analysis - Net Ad Profit (Summary)",aa_ROAS_kpr:"Ad Analysis - ROAS (Key Performance Indicator)",aa_ACOS_kpr:"Ad Analysis - ACOS % (Key Performance Indicator)",aa_CVR_kpr:"Ad Analysis - Ad Conversion Rate % (Key Performance Indicator)",aa_CPA_kpr:"Ad Analysis - Cost Per Acquisition (Key Performance Indicator)",aa_totalAdRevenue_prof:"Ad Analysis - Total Ad Revenue (Profitability)",aa_totalAdSpend_prof:"Ad Analysis - Total Ad Spend (Profitability)",aa_COGS_prof:"Ad Analysis - Product & Etsy Fees (COGS for Ad Sales)",aa_totalCosts_prof:"Ad Analysis - Total Costs for Ads",aa_netProfit_prof:"Ad Analysis - Net Profit from Ads",aa_netProfitMargin_prof:"Ad Analysis - Net Profit Margin from Ads %",aa_profitStatus_prof:"Ad Analysis - Ad Profit Status",aa_ROAS_prof:"Ad Analysis - ROAS (Profitability)",aa_breakevenROAS_prof:"Ad Analysis - Breakeven ROAS",aa_ACOS_prof:"Ad Analysis - ACOS % (Profitability)",aa_breakevenACOS_prof:"Ad Analysis - Breakeven ACOS %",aa_adImpressions_eng:"Ad Analysis - Ad Impressions/Views (Engagement)",aa_adClicks_eng:"Ad Analysis - Ad Clicks (Engagement)",aa_CTR_eng:"Ad Analysis - Click-Through Rate (CTR) %",aa_totalAdSpend_eng:"Ad Analysis - Total Ad Spend (Engagement)",aa_CPC_eng:"Ad Analysis - Cost Per Click (CPC)",aa_CPM_eng:"Ad Analysis - Cost Per Mille (CPM)",aa_RPC_eng:"Ad Analysis - Revenue Per Click (RPC)",aa_PPC_eng:"Ad Analysis - Profit Per Click (PPC)",aa_adOrders_eng:"Ad Analysis - Orders from Ads (Engagement)",aa_CVR_eng:"Ad Analysis - Ad Conversion Rate % (Engagement)",aa_AOV_eng:"Ad Analysis - Average Order Value (AOV) from Ads",aa_CPA_eng:"Ad Analysis - Cost Per Acquisition (CPA - Engagement)",aa_profitPerSale_eng:"Ad Analysis - Profit Earned per Ad Sale",co_blendedROAS:"Comparison - Blended ROAS (Overall Shop Revenue / Total Ad Spend)",co_overallShopNetProfitLoss:"Comparison - Overall Shop Net Profit/Loss",co_TACoS_percent:"Comparison - Total Advertising Cost of Sales (TACoS) %",co_percentRevenueFromAds:"Comparison - Revenue from Ads % of Total Shop Revenue",co_percentOrdersFromAds:"Comparison - Orders from Ads % of Total Shop Orders",co_organicCVR_forOverview:"Comparison - Organic Conversion Rate % (Overview)",co_adCVR_forOverview:"Comparison - Ad Conversion Rate % (Overview)",co_organicAOV_forOverview:"Comparison - Organic Average Order Value (Overview)",co_adAOV_forOverview:"Comparison - Ad Average Order Value (Overview)",cdt_ad_visits:"Channel Deep Dive - Ad Channel Visits/Clicks",cdt_ad_orders:"Channel Deep Dive - Ad Channel Orders",cdt_ad_cvr:"Channel Deep Dive - Ad Channel Conversion Rate %",cdt_ad_revenue:"Channel Deep Dive - Ad Channel Revenue",cdt_ad_aov:"Channel Deep Dive - Ad Channel Average Order Value",cdt_ad_revenuePercent:"Channel Deep Dive - Ad Channel Revenue as % of Total",cdt_ad_ordersPercent:"Channel Deep Dive - Ad Channel Orders as % of Total",cdt_organic_visits:"Channel Deep Dive - Organic Channel Visits",cdt_organic_orders:"Channel Deep Dive - Organic Channel Orders",cdt_organic_cvr:"Channel Deep Dive - Organic Channel Conversion Rate %",cdt_organic_revenue:"Channel Deep Dive - Organic Channel Revenue",cdt_organic_aov:"Channel Deep Dive - Organic Channel Average Order Value",cdt_organic_revenuePercent:"Channel Deep Dive - Organic Channel Revenue as % of Total",cdt_organic_ordersPercent:"Channel Deep Dive - Organic Channel Orders as % of Total",cdt_total_visits:"Channel Deep Dive - Overall Shop Visits/Clicks",cdt_total_orders:"Channel Deep Dive - Overall Shop Orders",cdt_total_cvr:"Channel Deep Dive - Overall Shop Conversion Rate %",cdt_total_revenue:"Channel Deep Dive - Overall Shop Revenue",cdt_total_aov:"Channel Deep Dive - Overall Shop Average Order Value",m_budget_totalBudgetedForPeriod:"Budget - Total Budgeted For Period",m_budget_utilization_percent:"Budget - Budget Utilization %"};function Be(){const e=te(),a=re();let r=`Metric,Value\r
`;for(const n in e)if(Object.hasOwnProperty.call(e,n)){const c=N[n]||n.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());let u=e[n];n==="selectedPeriodString"||n==="currencyCode"?u=`"${String(u).replace(/"/g,'""')}"`:typeof u=="boolean"?u=u?"Yes":"No":typeof u=="number"?n.toLowerCase().includes("_percent")?u=_(u,!0):n.toLowerCase().includes("spend")||n.toLowerCase().includes("revenue")||n.toLowerCase().includes("budget")||n.toLowerCase().includes("aov")?u=g(u,e.currencyCode,!1,!0):u=m(u,2,!0):u=`"${String(u).replace(/"/g,'""')}"`,r+=`"${c.replace(/"/g,'""')}",${u}\r
`}for(const n in a)if(Object.hasOwnProperty.call(a,n)){const c=N[n]||n.replace(/_/g," ").replace(/\b\w/g,f=>f.toUpperCase()),u=a[n];let p=u;typeof u=="number"?n.toLowerCase().includes("percent")||n.toLowerCase().includes("cvr")||n.toLowerCase().includes("acos")||n.toLowerCase().includes("ctr")||n==="m_budget_utilization_percent"?p=_(u,!0):n.toLowerCase().includes("spend")||n.toLowerCase().includes("revenue")||n.toLowerCase().includes("profit")||n.toLowerCase().includes("cpc")||n.toLowerCase().includes("cpm")||n.toLowerCase().includes("rpc")||n.toLowerCase().includes("ppc")||n.toLowerCase().includes("aov")||n.toLowerCase().includes("cpa")||n==="m_budget_totalBudgetedForPeriod"?p=g(u,e.currencyCode,!1,!0):n.toLowerCase().includes("roas")?p=m(u,2,!0):n==="aa_performancePeriod"?p=v(u,!0):p=m(u,2,!0):typeof u=="string"&&(p=`"${u.replace(/"/g,'""')}"`),r+=`"${c.replace(/"/g,'""')}",${p}\r
`}const o=encodeURI(r),i=document.createElement("a");i.setAttribute("href",o);const l=`etsy_ads_performance_export_${new Date().toISOString().replace(/[:.]/g,"-")}.csv`;i.setAttribute("download",l),document.body.appendChild(i),i.click(),document.body.removeChild(i)}function Ie(){typeof preloadAllMappedIcons=="function"?preloadAllMappedIcons():console.warn("preloadAllMappedIcons function not found. Ensure iconHandler.js is loaded correctly."),[t.totalAdSpend,t.totalAdRevenue_fromAds,t.averageProductProfitMargin_percent,t.adv_totalAdSpend,t.adv_totalAdRevenue_fromAds,t.adv_averageProductProfitMargin_percent,t.adImpressions,t.adClicks,t.adOrders,t.dailyAdBudget,t.performancePeriodDropdown,t.currencySymbol,t.totalOverallShopRevenue,t.totalOverallShopOrders,t.totalShopVisits].forEach(a=>{a&&(a.addEventListener("input",L),a.tagName==="SELECT"&&a.addEventListener("change",L))}),t.toggleNormalViewButton&&t.toggleNormalViewButton.addEventListener("click",()=>I("normal")),t.toggleAdvancedViewButton&&t.toggleAdvancedViewButton.addEventListener("click",()=>I("advanced")),t.adAnalysisTabButtons&&t.adAnalysisTabContents&&t.adAnalysisTabButtons.forEach(a=>{a.addEventListener("click",()=>B(a,t.adAnalysisTabButtons,t.adAnalysisTabContents))}),t.comparisonMetricsTabButtons&&t.comparisonMetricsTabContents&&t.comparisonMetricsTabButtons.forEach(a=>{a.addEventListener("click",()=>B(a,t.comparisonMetricsTabButtons,t.comparisonMetricsTabContents))}),t.exportCsvButton&&t.exportCsvButton.addEventListener("click",Be),me(),I("normal"),H(),R(),t.adAnalysisTabButtons&&t.adAnalysisTabButtons.length>0&&t.adAnalysisTabContents&&B(t.adAnalysisTabButtons[0],t.adAnalysisTabButtons,t.adAnalysisTabContents),t.comparisonMetricsTabButtons&&t.comparisonMetricsTabButtons.length>0&&t.comparisonMetricsTabContents&&B(t.comparisonMetricsTabButtons[0],t.comparisonMetricsTabButtons,t.comparisonMetricsTabContents)}document.addEventListener("DOMContentLoaded",Ie);
